(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c7671638"],{"13ab":function(e,t,n){},2532:function(e,t,n){"use strict";var i=n("23e7"),a=n("5a34"),c=n("1d80"),r=n("ab13");i({target:"String",proto:!0,forced:!r("includes")},{includes:function(e){return!!~String(c(this)).indexOf(a(e),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(e,t,n){var i=n("861d"),a=n("c6b6"),c=n("b622"),r=c("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[r])?!!t:"RegExp"==a(e))}},"468f":function(e,t,n){"use strict";n("f298")},"5a34":function(e,t,n){var i=n("44e7");e.exports=function(e){if(i(e))throw TypeError("The method doesn't accept regular expressions");return e}},"7db0":function(e,t,n){"use strict";var i=n("23e7"),a=n("b727").find,c=n("44d2"),r="find",o=!0;r in[]&&Array(1)[r]((function(){o=!1})),i({target:"Array",proto:!0,forced:o},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),c(r)},a0c2:function(e,t,n){"use strict";n("13ab")},ab13:function(e,t,n){var i=n("b622"),a=i("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[a]=!1,"/./"[e](t)}catch(i){}}return!1}},b74e:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return d}));var i=n("1da1"),a=n("3835");n("96cf"),n("159b"),n("4fad"),n("c1f9"),n("4de4"),n("caad"),n("2532");function c(e,t){var n=!0;return Object.entries(e).forEach((function(e){var i=Object(a["a"])(e,2),c=i[0],r=i[1];null!=r&&""!=r||(t[c]="Este campo es obligatorio",n=!1)})),n}function r(e,t){var n=Object.fromEntries(Object.entries(t).filter((function(t){var n=Object(a["a"])(t,1),i=n[0];return e.includes(i)})));return n}function o(e){var t=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(String(e).toLowerCase())}function s(e){var t=/^(?=.*\d)(?=.*[!@#$%^&*])(?=.*[a-z])(?=.*[A-Z]).{10,}$/;return t.test(e)}function u(e){var t=/^(?=.{9})(?!.{16})\+?\d+(-\d+)*$/;return t.test(e)}function d(e){return l.apply(this,arguments)}function l(){return l=Object(i["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.ok){e.next=5;break}return e.next=3,t.text();case 3:throw n=e.sent,new Error(n);case 5:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}},c1f9:function(e,t,n){var i=n("23e7"),a=n("2266"),c=n("8418");i({target:"Object",stat:!0},{fromEntries:function(e){var t={};return a(e,(function(e,n){c(t,e,n)}),{AS_ENTRIES:!0}),t}})},caad:function(e,t,n){"use strict";var i=n("23e7"),a=n("4d64").includes,c=n("44d2");i({target:"Array",proto:!0},{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),c("includes")},d097:function(e,t,n){"use strict";n.r(t);var i=n("7a23"),a=Object(i["W"])("data-v-323c902c");Object(i["E"])("data-v-323c902c");var c={class:"quiz"},r=Object(i["m"])("i",{class:"fas fa-chevron-left"},null,-1),o=Object(i["l"])(" Salir del quiz "),s=Object(i["m"])("h1",null,"Quiz",-1),u={key:0,class:"form"},d=Object(i["m"])("h3",{class:"form-header"}," Seleccione la lista de verificación que desea validar ",-1),l={class:"form-control"},p=Object(i["m"])("p",null,"Códido",-1),m={style:{"font-size":"14px","margin-left":"40px","font-weight":"100"}},b={class:"form-control"},v=Object(i["m"])("p",null,"Fecha de creación",-1),f={class:"non-editable"},j={key:2,class:"form"},h={key:0,class:"form-header-criterio"},O={class:"form-header"},g={class:"form-control"},x=Object(i["m"])("p",null,"Respuesta",-1),I={class:"radio-form",style:{"margin-left":"120px"}},k=Object(i["m"])("label",{for:"totalmente"},"Totalmente",-1),w={class:"radio-form"},R=Object(i["m"])("label",{for:"parcialmente"},"Parcialmente",-1),y={class:"radio-form"},q=Object(i["m"])("label",{for:"noimplementado"},"No implementado",-1),E={class:"radio-form"},C=Object(i["m"])("label",{for:"noaplica"},"No aplica",-1),T={key:1,class:"form-control"},S=Object(i["m"])("p",null,"Justificación",-1),B={key:2,class:"form-control"},L=Object(i["m"])("p",null,"Evidencia:",-1),N=Object(i["m"])("label",{for:"nuevo",style:{"margin-left":"122px"}},"Nueva",-1),D={class:"switch"},$=Object(i["m"])("span",{class:"slider round"},null,-1),z={key:3},V={key:0,class:"form-control"},A=Object(i["m"])("p",null,"Nombre del Documento:",-1),U={key:1,class:"form-control"},P=Object(i["m"])("p",null,"Archivo adjunto:",-1),J={class:"link"},_={for:"files",class:"btn",style:{cursor:"pointer"}},H=Object(i["m"])("i",{class:"fas fa-paperclip"},null,-1),F={key:4},G={key:0,class:"form-control"},M=Object(i["m"])("p",null,"Documento",-1),Q={class:"link"},Z={style:{"margin-top":"3px","font-weight":"100","margin-left":"20px",cursor:"pointer"}},W={style:{position:"absolute",left:"72px"}},K={key:5},X={class:"containerizq"},Y={class:"col"},ee={class:"grid"},te=Object(i["m"])("thead",{class:"header-grid"},[Object(i["m"])("tr",null,[Object(i["m"])("th",null,"Criterio"),Object(i["m"])("th",null,"Puntaje"),Object(i["m"])("th",null,"Porcentaje de cumplimiento")])],-1),ne=Object(i["m"])("p",null," ",-1),ie=Object(i["m"])("p",null," ",-1),ae=Object(i["m"])("p",null," ",-1),ce=Object(i["m"])("p",null," ",-1),re=Object(i["m"])("p",null," ",-1),oe=Object(i["m"])("p",null," ",-1),se=Object(i["m"])("p",null," ",-1),ue=Object(i["m"])("p",null," ",-1),de=Object(i["m"])("p",null," ",-1),le={class:"col"},pe={class:"containerder"},me=Object(i["m"])("h3",{class:"form-header final resultados"},"Resultados finales",-1),be={class:"grid summary"},ve=Object(i["m"])("td",null,"Porcentaje de cumplimiento total",-1),fe=Object(i["m"])("td",null,"Nivel de riesgo",-1);Object(i["C"])();var je=a((function(e,t,n,a,je,he){var Oe,ge,xe,Ie,ke,we=Object(i["J"])("nav-bar"),Re=Object(i["J"])("modal");return Object(i["B"])(),Object(i["j"])(i["b"],null,[Object(i["m"])(we,{name:null===(Oe=e.userInfoJson)||void 0===Oe?void 0:Oe.nombres,lastName:null===(ge=e.userInfoJson)||void 0===ge?void 0:ge.apellidos},null,8,["name","lastName"]),Object(i["m"])(Re,{show:!!e.loading,title:e.message,onClose:t[1]||(t[1]=function(){}),error:e.error,loading:e.loading},null,8,["show","title","error","loading"]),Object(i["m"])("section",c,[Object(i["m"])("h3",{class:"back",onClick:t[2]||(t[2]=function(){return e.backToEvluacion&&e.backToEvluacion.apply(e,arguments)})},[r,o]),s,e.start?Object(i["k"])("",!0):(Object(i["B"])(),Object(i["j"])("div",u,[d,Object(i["m"])("div",l,[p,Object(i["m"])("input",{type:"text",value:e.selectedListaVerificacion.codigo},null,8,["value"]),Object(i["m"])("p",m,Object(i["L"])(e.selectedListaVerificacion.requerimientos.length)+" requerimientos ",1)]),Object(i["m"])("div",b,[v,Object(i["m"])("div",f,Object(i["L"])(new Date(e.selectedListaVerificacion.fechaCreacion).toLocaleDateString()),1)])])),e.start?Object(i["k"])("",!0):(Object(i["B"])(),Object(i["j"])("button",{key:1,class:"action-button",onClick:t[3]||(t[3]=function(){return e.startQuiz&&e.startQuiz.apply(e,arguments)})}," Iniciar Quiz ")),e.start&&!e.showResultado&&e.evidenciaRequerimiento&&e.evidenciaRequerimiento[e.stepIndex]?(Object(i["B"])(),Object(i["j"])("section",j,[void 0!==(null===(xe=e.requerimientos[e.stepIndex])||void 0===xe?void 0:xe.criterio)?(Object(i["B"])(),Object(i["j"])("h4",h," Criterio: "+Object(i["L"])(null===(Ie=e.requerimientos[e.stepIndex])||void 0===Ie?void 0:Ie.criterio.descripcion),1)):Object(i["k"])("",!0),Object(i["m"])("h5",O," Pregunta "+Object(i["L"])(e.questionNumber+1)+":   "+Object(i["L"])(null===(ke=e.requerimientos[e.stepIndex])||void 0===ke?void 0:ke.descripcion),1),Object(i["m"])("div",g,[x,Object(i["m"])("div",I,[k,Object(i["U"])(Object(i["m"])("input",{type:"radio",name:"totalmente",id:"1",value:"1","onUpdate:modelValue":t[4]||(t[4]=function(t){return e.evidenciaRequerimiento[e.stepIndex].respuestaItem=t})},null,512),[[i["O"],e.evidenciaRequerimiento[e.stepIndex].respuestaItem]])]),Object(i["m"])("div",w,[R,Object(i["U"])(Object(i["m"])("input",{type:"radio",name:"parcialmente",id:"0.5",value:"0.5","onUpdate:modelValue":t[5]||(t[5]=function(t){return e.evidenciaRequerimiento[e.stepIndex].respuestaItem=t})},null,512),[[i["O"],e.evidenciaRequerimiento[e.stepIndex].respuestaItem]])]),Object(i["m"])("div",y,[q,Object(i["U"])(Object(i["m"])("input",{type:"radio",name:"noimplementado",id:"0",value:"0","onUpdate:modelValue":t[6]||(t[6]=function(t){return e.evidenciaRequerimiento[e.stepIndex].respuestaItem=t})},null,512),[[i["O"],e.evidenciaRequerimiento[e.stepIndex].respuestaItem]])]),Object(i["m"])("div",E,[C,Object(i["U"])(Object(i["m"])("input",{type:"radio",name:"noaplica",id:"null",value:"null","onUpdate:modelValue":t[7]||(t[7]=function(t){return e.evidenciaRequerimiento[e.stepIndex].respuestaItem=t})},null,512),[[i["O"],e.evidenciaRequerimiento[e.stepIndex].respuestaItem]])])]),"null"!=e.evidenciaRequerimiento[e.stepIndex].respuestaItem?(Object(i["B"])(),Object(i["j"])("div",T,[S,Object(i["U"])(Object(i["m"])("input",{style:{"margin-left":"102px",width:"400px"},type:"text","onUpdate:modelValue":t[8]||(t[8]=function(t){return e.evidenciaRequerimiento[e.stepIndex].justificacion=t})},null,512),[[i["Q"],e.evidenciaRequerimiento[e.stepIndex].justificacion]])])):Object(i["k"])("",!0),"null"!=e.evidenciaRequerimiento[e.stepIndex].respuestaItem?(Object(i["B"])(),Object(i["j"])("div",B,[L,N,Object(i["m"])("label",D,[Object(i["U"])(Object(i["m"])("input",{type:"checkbox",id:"checkbox",name:"nuevo","onUpdate:modelValue":t[9]||(t[9]=function(t){return e.nuevaEvidencia=t})},null,512),[[i["N"],e.nuevaEvidencia]]),$])])):Object(i["k"])("",!0),e.nuevaEvidencia?(Object(i["B"])(),Object(i["j"])("div",z,["null"!=e.evidenciaRequerimiento[e.stepIndex].respuestaItem?(Object(i["B"])(),Object(i["j"])("div",V,[A,Object(i["U"])(Object(i["m"])("input",{style:{"margin-left":"20px",width:"300px"},type:"text","onUpdate:modelValue":t[10]||(t[10]=function(t){return e.evidencia[e.stepIndex].nombre=t})},null,512),[[i["Q"],e.evidencia[e.stepIndex].nombre]])])):Object(i["k"])("",!0),"null"!=e.evidenciaRequerimiento[e.stepIndex].respuestaItem?(Object(i["B"])(),Object(i["j"])("div",U,[P,Object(i["m"])("div",J,[Object(i["m"])("label",_,Object(i["L"])(e.uploadText),1),Object(i["m"])("input",{id:"files",style:{visibility:"hidden"},type:"file",onChange:t[11]||(t[11]=function(t){return e.fileChange(t.target.files)})},null,32),H])])):Object(i["k"])("",!0)])):(Object(i["B"])(),Object(i["j"])("div",F,["null"!=e.evidenciaRequerimiento[e.stepIndex].respuestaItem?(Object(i["B"])(),Object(i["j"])("div",G,[M,Object(i["m"])("div",Q,[Object(i["U"])(Object(i["m"])("input",{type:"text",placeholder:"Buscar por código",onKeyup:t[12]||(t[12]=function(){return e.fetchEvidencias&&e.fetchEvidencias.apply(e,arguments)}),"onUpdate:modelValue":t[13]||(t[13]=function(t){return e.evidencia[e.stepIndex].codigoEvidencia=t}),style:{"margin-left":"-3px"}},null,544),[[i["Q"],e.evidencia[e.stepIndex].codigoEvidencia,void 0,{trim:!0}]]),Object(i["m"])("p",Z,Object(i["L"])(e.evidencia[e.stepIndex].adjunto),1),Object(i["m"])("div",W,[(Object(i["B"])(!0),Object(i["j"])(i["b"],null,Object(i["H"])(e.evidenciasFetched,(function(t){return Object(i["B"])(),Object(i["j"])("p",{class:"dropdownSelect",key:t.evidenciaId,onClick:function(n){return e.selectEvidencia(t)}},Object(i["L"])(t.codigo+"-"+t.nombre),9,["onClick"])})),128))])])])):Object(i["k"])("",!0)]))])):Object(i["k"])("",!0),e.questionNumber>0&&!e.showResultado?(Object(i["B"])(),Object(i["j"])("button",{key:3,class:"action-button main-form left",onClick:t[14]||(t[14]=function(){return e.previous&&e.previous.apply(e,arguments)})}," Anterior ")):Object(i["k"])("",!0),e.start&&!e.showResultado?(Object(i["B"])(),Object(i["j"])("button",{key:4,class:"action-button main-form",onClick:t[15]||(t[15]=function(){return e.next&&e.next.apply(e,arguments)})},Object(i["L"])(e.end?"Finalizar":"Continuar"),1)):Object(i["k"])("",!0),e.showResultado?(Object(i["B"])(),Object(i["j"])("div",K,[Object(i["m"])("div",X,[Object(i["m"])("div",Y,[Object(i["m"])("table",ee,[te,Object(i["m"])("tbody",null,[(Object(i["B"])(!0),Object(i["j"])(i["b"],null,Object(i["H"])(e.pruebaResultados.criteriosResultado.length,(function(t,n){return Object(i["B"])(),Object(i["j"])("tr",{key:t},[Object(i["m"])("td",null,Object(i["L"])(e.pruebaResultados.criteriosResultado[n].descripcion+" ("+e.pruebaResultados.criteriosResultado[n].peso+") "),1),Object(i["m"])("td",null,[ne,ie,ae,ce,re,Object(i["l"])(" "+Object(i["L"])(e.pruebaResultados.criteriosResultado[n].normalizedPuntaje),1)]),Object(i["m"])("td",null,[oe,se,ue,de,Object(i["l"])(" "+Object(i["L"])(e.pruebaResultados.criteriosResultado[n].porcentajeCumplimiento+"%"),1)])])})),128))])])]),Object(i["m"])("div",le,[Object(i["m"])("div",pe,[me,Object(i["m"])("table",be,[Object(i["m"])("tbody",null,[Object(i["m"])("tr",null,[ve,Object(i["m"])("td",null,Object(i["L"])(e.pruebaResultados.porcentajeCumplimientoTotal)+"%",1)]),Object(i["m"])("tr",null,[fe,Object(i["m"])("td",null,Object(i["L"])(e.pruebaResultados.nivelDeRiesgo),1)])]),Object(i["m"])("button",{class:"action-button main-form left final",onClick:t[16]||(t[16]=function(){return e.showSummary&&e.showSummary.apply(e,arguments)})}," Visualizar resumen "),Object(i["m"])("button",{class:"action-button main-form final",onClick:t[17]||(t[17]=function(){return e.submit&&e.submit.apply(e,arguments)})}," Guardar prueba ")])])])])])):Object(i["k"])("",!0)])],64)})),he=n("b85c"),Oe=n("5530"),ge=n("1da1"),xe=(n("96cf"),n("d3b7"),n("ac1f"),n("5319"),n("99af"),n("b0c0"),n("4e82"),n("d81d"),n("4ec9"),n("3ca3"),n("ddb0"),n("4de4"),n("7db0"),n("159b"),n("f464")),Ie=n("5c40"),ke=n("2fc2"),we=n("b74e"),Re=n("705f"),ye=n("f50d"),qe=n("d43e"),Ee=Object(Ie["p"])({components:{NavBar:xe["a"],Modal:Re["a"]},computed:{selectedListaVerificacion:function(){return this.$store.getters["listaVerificacionModule/selectedListaVerificacion"]},prueba:function(){return this.$store.getters["pruebaModule/obtenerPrueba"]},evaluacion:function(){return this.$store.getters["evaluacionModule/obtenerEvaluacion"]}},data:function(){return{userInfoJson:Object(qe["h"])(),date:(new Date).toLocaleDateString(),start:!1,criterios:[],requerimientos:[],evidenciaRequerimiento:[],evidencia:[],evidenciasFetched:[],pruebaResultados:{},obraId:"",criterioIndex:0,stepIndex:0,questionNumber:0,end:!1,showResultado:!1,loading:!1,error:!1,message:"",evaluacionDetalle:{},files:new FormData,uploadText:"Adjuntar archivo",nuevaEvidencia:!1,lastEvidenciaCodigo:"",timeout:void 0,hasSelectedEvidencia:!1}},methods:{selectEvidencia:function(e){this.hasSelectedEvidencia=!0,this.evidenciasFetched=[],this.evidencia[this.stepIndex]=e,this.evidencia[this.stepIndex].codigoEvidencia=e.codigo+"-"+e.nombre},changeUploadInterface:function(){this.nuevaEvidencia=!this.nuevaEvidencia},backToEvluacion:function(){this.$router.push("/evaluacion/".concat(this.evaluacion.codigo))},startQuiz:function(){var e=this;return Object(ge["a"])(regeneratorRuntime.mark((function t(){var n,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={EvaluacionId:e.evaluacion.evaluacionId,Codigo:e.prueba.codigo},t.prev=1,t.next=4,fetch("".concat(ke["c"],"prueba"),{method:"POST",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}),body:JSON.stringify(n)});case 4:return a=t.sent,t.next=7,a.json();case 7:i=t.sent,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](1),console.log(t.t0);case 13:e.$router.replace({path:"/evaluacion/".concat(e.evaluacion.codigo,"/prueba/").concat(i.codigo),query:{req:1}}),e.start=!0;case 15:case"end":return t.stop()}}),t,null,[[1,10]])})))()},obtenerPruebaResults:function(){var e=this;return Object(ge["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(ke["c"],"prueba/").concat(e.prueba.codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return n=t.sent,t.next=6,Object(we["a"])(n);case 6:return t.next=8,n.json();case 8:e.pruebaResultados=t.sent,t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),e.error=!0,JSON.parse(t.t0.message);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))()},registrarEvidenciaRequerimiento:function(){var e=this;return Object(ge["a"])(regeneratorRuntime.mark((function t(){var n,i,a,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,"null"===e.evidenciaRequerimiento[e.stepIndex].respuestaItem&&(e.evidenciaRequerimiento[e.stepIndex].justificacion="",e.evidencia[e.stepIndex].nombre=""),e.evidencia[e.stepIndex].evidenciaId||""==e.evidencia[e.stepIndex].nombre||null==e.evidencia[e.stepIndex].nombre){t.next=7;break}return t.next=5,e.evidenciasCount();case 5:e.evidencia[e.stepIndex].codigo=e.lastEvidenciaCodigo,e.evidencia[e.stepIndex].codigoEvidencia=e.evidencia[e.stepIndex].codigo+"-"+e.evidencia[e.stepIndex].nombre;case 7:return n={EvidenciaId:e.evidencia[e.stepIndex].evidenciaId?e.evidencia[e.stepIndex].evidenciaId:null,RequerimientoId:e.requerimientos[e.stepIndex].requerimientoId,PruebaCodigo:e.$route.params.pr_codigo,EvidenciaNombre:e.evidencia[e.stepIndex].nombre,EvidenciaCodigo:e.evidencia[e.stepIndex].codigo,Justificacion:e.evidenciaRequerimiento[e.stepIndex].justificacion,RespuestaItem:JSON.parse(e.evidenciaRequerimiento[e.stepIndex].respuestaItem)},t.next=10,fetch("".concat(ke["c"],"evidenciarequerimiento"),{method:"POST",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}),body:JSON.stringify(n)});case 10:return i=t.sent,t.next=13,Object(we["a"])(i);case 13:return t.next=15,i.json();case 15:if(a=t.sent,a.evidenciaId&&(e.evidencia[e.stepIndex].evidenciaId=a.evidenciaId),t.t0=a.evidenciaId,!t.t0){t.next=21;break}return t.next=21,e.upload(a.evidenciaId);case 21:t.next=29;break;case 23:t.prev=23,t.t1=t["catch"](0),e.error=!0,console.log(t.t1),c=JSON.parse(t.t1.message),console.log(c.errores);case 29:case"end":return t.stop()}}),t,null,[[0,23]])})))()},next:function(){var e=this;return Object(ge["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.registrarEvidenciaRequerimiento();case 3:if(!e.end){t.next=11;break}return e.stepIndex=0,t.next=7,e.obtenerPruebaResults();case 7:e.showResultado=!0,e.loading=!1,t.next=22;break;case 11:if(!e.evidencia[e.stepIndex+1]&&e.evidencia.push(Object(qe["c"])()),!e.evidenciaRequerimiento[e.stepIndex+1]&&e.evidenciaRequerimiento.push(Object(qe["d"])()),e.requerimientos[e.stepIndex+2]||(e.end=!0),!e.requerimientos[e.stepIndex+1]){t.next=18;break}e.stepIndex+=1,t.next=20;break;case 18:return e.loading=!1,t.abrupt("return");case 20:e.questionNumber+=1,e.$router.push({path:"/evaluacion/".concat(e.evaluacion.codigo,"/prueba/").concat(e.$route.params.pr_codigo),query:{req:e.questionNumber+1}});case 22:e.files=new FormData,e.loading=!1,e.hasSelectedEvidencia=!1,e.nuevaEvidencia=!1;case 26:case"end":return t.stop()}}),t)})))()},previous:function(){this.requerimientos[this.stepIndex-1]&&(this.stepIndex-=1,this.questionNumber-=1,this.end=!1,this.hasSelectedEvidencia=!1,this.nuevaEvidencia=!1,this.$router.replace({path:"/evaluacion/".concat(this.evaluacion.codigo,"/prueba/").concat(this.$route.params.pr_codigo),query:{req:this.questionNumber+1}}))},showSummary:function(){this.$router.push("/lista-verificacion/".concat(this.selectedListaVerificacion.codigo,"/prueba/").concat(this.$route.params.pr_codigo,"/resumen"))},submit:function(){var e=this;Object(ge["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(ke["c"],"prueba/activar/").concat(e.prueba.codigo),{method:"PUT",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),console.log(t.t0);case 8:e.$router.push("/evaluacion/"+e.evaluacion.codigo);case 9:case"end":return t.stop()}}),t,null,[[0,5]])})))()},fileChange:function(e){this.files=new FormData,this.evidencia[this.stepIndex].evidenciaId=void 0,this.files.append("file",e[0],e[0].name),this.uploadText=e[0].name},upload:function(e){var t=this;return Object(ge["a"])(regeneratorRuntime.mark((function n(){var i,a,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,i=t.files,n.next=4,fetch("".concat(ke["c"],"evidencia/upload/").concat(e),{method:"POST",headers:new Headers({Authorization:"Bearer "+localStorage.getItem("token")}),body:i});case 4:return a=n.sent,n.next=7,a.json();case 7:c=n.sent,console.log(c,t.evidencia[t.stepIndex].evidenciaId),t.evidencia[t.stepIndex].evidenciaId&&c&&(t.evidencia[t.stepIndex]=Object(Oe["a"])(Object(Oe["a"])({},t.evidencia[t.stepIndex]),c)),t.files=new FormData,t.uploadText="Adjuntar archivo",n.next=17;break;case 14:n.prev=14,n.t0=n["catch"](0),console.log(n.t0);case 17:case"end":return n.stop()}}),n,null,[[0,14]])})))()},fetchEvidencias:function(){var e=this;return Object(ge["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:clearTimeout(e.timeout),e.timeout=setTimeout(Object(ge["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(ke["c"],"evidencia/lista?filter=").concat(e.evidencia[e.stepIndex].codigoEvidencia),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return n=t.sent,t.next=6,Object(we["a"])(n);case 6:return t.next=8,n.json();case 8:e.evidenciasFetched=t.sent,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])}))),1e3);case 2:case"end":return t.stop()}}),t)})))()},evidenciasCount:function(){var e=this;return Object(ge["a"])(regeneratorRuntime.mark((function t(){var n,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(ke["c"],"evidencia/ultimoCodigo"),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return n=t.sent,t.next=6,n.json();case 6:i=t.sent,a=i.codigo,e.lastEvidenciaCodigo=a,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()}},mounted:function(){var e=this;Object(ge["a"])(regeneratorRuntime.mark((function t(){var n,i,a,c,r,o,s,u,d,l,p,m,b;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(ye["a"])();case 2:return e.userInfoJson=t.sent,t.next=5,e.evidenciasCount();case 5:return n=[],t.prev=6,t.next=9,fetch("".concat(ke["c"],"evaluacion/").concat(e.$route.params.ev_codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 9:if(i=t.sent,"No Content"===i.statusText){t.next=19;break}return t.next=13,i.json();case 13:e.evaluacionDetalle=t.sent,e.selectedListaVerificacion.fechaCreacion=e.evaluacionDetalle.listaVerificacionFechaCreacion,e.selectedListaVerificacion.requerimientosCount=e.evaluacionDetalle.requerimientosCount,e.selectedListaVerificacion.codigo=e.evaluacionDetalle.codigoListaVerificacion,e.obraId=e.evaluacionDetalle.obraId,e.$store.dispatch("evaluacionModule/guardarEvaluacion",Object(Oe["a"])(Object(Oe["a"])({},e.evaluacion),{},{evaluacionId:e.evaluacionDetalle.evaluacionId,codigo:e.evaluacionDetalle.codigo,nombre:e.evaluacionDetalle.nombre,estado:e.evaluacionDetalle.estado,visibilidad:e.evaluacionDetalle.visibilidad,fechaCreacion:new Date(e.evaluacionDetalle.fechaCreacion).toLocaleDateString()}));case 19:t.next=24;break;case 21:t.prev=21,t.t0=t["catch"](6),console.log(t.t0);case 24:return t.prev=24,t.next=27,fetch("".concat(ke["c"],"listaverificaciones/lista?filter=").concat(e.evaluacionDetalle.codigoListaVerificacion),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 27:return a=t.sent,t.next=30,a.json();case 30:n=t.sent,e.$store.dispatch("listaVerificacionModule/guardarListaVerificacion",Object(Oe["a"])({},n[0])),c=n[0].requerimientos.map((function(e){return e.criterio})).sort((function(e,t){return e.descripcion.localeCompare(t.descripcion)})),r=new Map,o=Object(he["a"])(c);try{for(o.s();!(s=o.n()).done;)u=s.value,r.has(u.descripcion)||(r.set(u.descripcion,!0),e.criterios.push(u))}catch(v){o.e(v)}finally{o.f()}e.requerimientos=e.selectedListaVerificacion.requerimientos.sort((function(e,t){return e.criterio.descripcion.localeCompare(t.criterio.descripcion)})),e.evidencia.push(Object(qe["c"])()),e.evidencia[0].codigo=e.lastEvidenciaCodigo,e.evidenciaRequerimiento.push(Object(qe["d"])()),t.next=45;break;case 42:t.prev=42,t.t1=t["catch"](24),console.log(t.t1);case 45:if(void 0!=e.$route.params.pr_codigo){t.next=62;break}return t.prev=46,t.next=49,fetch("".concat(ke["c"],"prueba/ultimoCodigo"),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 49:return d=t.sent,t.next=52,d.json();case 52:l=t.sent,p=l.codigo,e.$store.dispatch("pruebaModule/guardarPrueba",Object(Oe["a"])(Object(Oe["a"])({},e.prueba),{},{codigo:p})),t.next=60;break;case 57:t.prev=57,t.t2=t["catch"](46),console.log(t.t2);case 60:t.next=80;break;case 62:return e.$store.dispatch("pruebaModule/guardarPrueba",Object(Oe["a"])(Object(Oe["a"])({},e.prueba),{},{codigo:e.$route.params.pr_codigo})),t.prev=63,t.next=66,fetch("".concat(ke["c"],"evidenciarequerimiento/").concat(e.$route.params.pr_codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 66:return m=t.sent,t.next=69,m.json();case 69:b=t.sent,b.length>0&&(e.evidencia=[],e.evidenciaRequerimiento=[],b=e.requerimientos.map((function(e){return b.find((function(t){return t.requerimientoId==e.requerimientoId}))})).filter((function(e){return void 0!==e})),b.forEach((function(t){var n,i,a,c,r,o,s,u;e.evidencia.push({evidenciaId:null===(n=t.evidencia)||void 0===n?void 0:n.evidenciaId,codigo:null===(i=t.evidencia)||void 0===i?void 0:i.codigo,nombre:null===(a=t.evidencia)||void 0===a?void 0:a.nombre,adjunto:null===(c=t.evidencia)||void 0===c?void 0:c.adjunto,codigoEvidencia:null!==(r=t.evidencia)&&void 0!==r&&r.codigo&&null!==(o=t.evidencia)&&void 0!==o&&o.nombre?t.evidencia.codigo+"-"+(null===(s=t.evidencia)||void 0===s?void 0:s.nombre):"",adjuntoURL:null===(u=t.evidencia)||void 0===u?void 0:u.adjuntoURL}),e.evidenciaRequerimiento.push({evidenciaId:t.evidenciaId,requerimientoId:t.requerimientoId,pruebaId:t.pruebaId,justificacion:t.justificacion,respuestaItem:t.respuestaItem,recomendacion:t.recomendacion})}))),b.length>0?(e.stepIndex=b.length-1,e.questionNumber=b.length-1):(e.stepIndex=0,e.questionNumber=0),e.requerimientos.length==b.length&&(e.end=!0),e.$router.replace({path:"/evaluacion/".concat(e.evaluacion.codigo,"/prueba/").concat(e.$route.params.pr_codigo),query:{req:e.questionNumber+1}}),e.start=!0,t.next=80;break;case 77:t.prev=77,t.t3=t["catch"](63),console.log(t.t3);case 80:case"end":return t.stop()}}),t,null,[[6,21],[24,42],[46,57],[63,77]])})))()},unmounted:function(){this.start=!1,this.criterioIndex=0,this.stepIndex=0,this.questionNumber=0,this.end=!1,this.showResultado=!1}}),Ce=(n("468f"),n("d959")),Te=n.n(Ce);const Se=Te()(Ee,[["render",je],["__scopeId","data-v-323c902c"]]);t["default"]=Se},f298:function(e,t,n){},f464:function(e,t,n){"use strict";n("b0c0");var i=n("7a23"),a=n("cc25"),c=n.n(a),r=Object(i["W"])("data-v-dbc28712");Object(i["E"])("data-v-dbc28712");var o={class:"header"};Object(i["C"])();var s=r((function(e,t,n,a,r,s){return Object(i["B"])(),Object(i["j"])("div",o,[Object(i["m"])("img",{id:"logo",onClick:t[1]||(t[1]=function(t){return e.goToDashboard()}),alt:"logo_banner",src:c.a,width:"120",height:"50"}),Object(i["m"])("p",null,"Bienvenido: "+Object(i["L"])(e.name+" "+e.lastName),1)])})),u=n("5c40"),d=Object(u["p"])({props:["name","lastName"],methods:{goToDashboard:function(){this.$router.push("/dashboard")}}}),l=(n("a0c2"),n("d959")),p=n.n(l);const m=p()(d,[["render",s],["__scopeId","data-v-dbc28712"]]);t["a"]=m},f50d:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("1da1"),a=(n("96cf"),n("d3b7"),n("2fc2"));function c(){return r.apply(this,arguments)}function r(){return r=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(a["c"],"usuario"),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)}))),r.apply(this,arguments)}}}]);
//# sourceMappingURL=chunk-c7671638.18b3aeb0.js.map