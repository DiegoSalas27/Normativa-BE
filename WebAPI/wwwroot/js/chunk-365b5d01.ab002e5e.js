(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-365b5d01"],{"6a19":function(e,t,n){},d097:function(e,t,n){"use strict";n.r(t);var i=n("7a23"),a=Object(i["J"])("data-v-d83030a2");Object(i["s"])("data-v-d83030a2");var c={class:"quiz"},o=Object(i["g"])("i",{class:"fas fa-chevron-left"},null,-1),r=Object(i["f"])(" Salir del quiz "),s=Object(i["g"])("h1",null,"Quiz",-1),u={key:0,class:"form"},d=Object(i["g"])("h3",{class:"form-header"}," Seleccione la lista de verificación que desea validar ",-1),l={class:"form-control"},p=Object(i["g"])("p",null,"Códido",-1),b={style:{"font-size":"14px","margin-left":"40px","font-weight":"100"}},v={class:"form-control"},m=Object(i["g"])("p",null,"Fecha de creación",-1),g={class:"non-editable"},j={key:2,class:"form"},f={key:0,class:"form-header-criterio"},h={class:"form-header"},O={class:"form-control"},x=Object(i["g"])("p",null,"Respuesta",-1),I={class:"radio-form",style:{"margin-left":"120px"}},R=Object(i["g"])("label",{for:"totalmente"},"Totalmente",-1),q={class:"radio-form"},k=Object(i["g"])("label",{for:"parcialmente"},"Parcialmente",-1),w={class:"radio-form"},y=Object(i["g"])("label",{for:"noimplementado"},"No implementado",-1),C={class:"radio-form"},E=Object(i["g"])("label",{for:"noaplica"},"No aplica",-1),z={key:1,class:"form-control"},S=Object(i["g"])("p",null,"Justificación",-1),T={key:2,class:"form-control"},D=Object(i["g"])("p",null,"Evidencia:",-1),N=Object(i["g"])("label",{for:"nuevo",style:{"margin-left":"122px"}},"Nueva",-1),V={class:"switch"},$=Object(i["g"])("span",{class:"slider round"},null,-1),H={key:3},L={key:0,class:"form-control"},P=Object(i["g"])("p",null,"Nombre del Documento:",-1),A={key:1,class:"form-control"},B=Object(i["g"])("p",null,"Archivo adjunto:",-1),J={class:"link"},U={for:"files",class:"btn",style:{cursor:"pointer"}},_=Object(i["g"])("i",{class:"fas fa-paperclip"},null,-1),F={key:4},M={key:0,class:"form-control"},G=Object(i["g"])("p",null,"Documento",-1),Q={class:"link"},K={style:{"margin-top":"3px","font-weight":"100","margin-left":"20px",cursor:"pointer"}},W={style:{position:"absolute",left:"72px"}},X={key:5},Y={class:"containerizq"},Z={class:"col"},ee={class:"grid"},te=Object(i["g"])("thead",{class:"header-grid"},[Object(i["g"])("tr",null,[Object(i["g"])("th",null,"Criterio"),Object(i["g"])("th",null,"Puntaje"),Object(i["g"])("th",null,"Porcentaje de cumplimiento")])],-1),ne=Object(i["g"])("p",null," ",-1),ie=Object(i["f"])(),ae=Object(i["g"])("p",null," ",-1),ce=Object(i["f"])(),oe=Object(i["g"])("p",null," ",-1),re=Object(i["f"])(),se=Object(i["g"])("p",null," ",-1),ue=Object(i["f"])(),de=Object(i["g"])("p",null," ",-1),le=Object(i["g"])("p",null," ",-1),pe=Object(i["f"])(),be=Object(i["g"])("p",null," ",-1),ve=Object(i["g"])("p",null," ",-1),me=Object(i["f"])(),ge=Object(i["g"])("p",null," ",-1),je={class:"col"},fe={class:"containerder"},he=Object(i["g"])("h3",{class:"form-header final resultados"},"Resultados finales",-1),Oe={class:"grid summary"},xe=Object(i["g"])("td",null,"Porcentaje de cumplimiento total",-1),Ie=Object(i["g"])("td",null,"Nivel de riesgo",-1);Object(i["q"])();var Re=a((function(e,t,n,a,Re,qe){var ke,we,ye,Ce,Ee,ze=Object(i["x"])("nav-bar"),Se=Object(i["x"])("modal");return Object(i["p"])(),Object(i["d"])(i["a"],null,[Object(i["g"])(ze,{name:null===(ke=e.userInfoJson)||void 0===ke?void 0:ke.nombres,lastName:null===(we=e.userInfoJson)||void 0===we?void 0:we.apellidos},null,8,["name","lastName"]),Object(i["g"])(Se,{show:!!e.loading,title:e.message,onClose:t[1]||(t[1]=function(){}),error:e.error,loading:e.loading},null,8,["show","title","error","loading"]),Object(i["g"])("section",c,[Object(i["g"])("h3",{class:"back",onClick:t[2]||(t[2]=function(){return e.backToEvluacion&&e.backToEvluacion.apply(e,arguments)})},[o,r]),s,e.start?Object(i["e"])("",!0):(Object(i["p"])(),Object(i["d"])("div",u,[d,Object(i["g"])("div",l,[p,Object(i["g"])("input",{type:"text",value:e.selectedListaVerificacion.codigo},null,8,["value"]),Object(i["g"])("p",b,Object(i["z"])(e.selectedListaVerificacion.requerimientos.length)+" requerimientos ",1)]),Object(i["g"])("div",v,[m,Object(i["g"])("div",g,Object(i["z"])(new Date(e.selectedListaVerificacion.fechaCreacion).toLocaleDateString()),1)])])),e.start?Object(i["e"])("",!0):(Object(i["p"])(),Object(i["d"])("button",{key:1,class:"action-button",onClick:t[3]||(t[3]=function(){return e.startQuiz&&e.startQuiz.apply(e,arguments)})}," Iniciar Quiz ")),e.start&&!e.showResultado&&e.evidenciaRequerimiento&&e.evidenciaRequerimiento[e.stepIndex]?(Object(i["p"])(),Object(i["d"])("section",j,[void 0!==(null===(ye=e.requerimientos[e.stepIndex])||void 0===ye?void 0:ye.criterio)?(Object(i["p"])(),Object(i["d"])("h4",f," Criterio: "+Object(i["z"])(null===(Ce=e.requerimientos[e.stepIndex])||void 0===Ce?void 0:Ce.criterio.descripcion),1)):Object(i["e"])("",!0),Object(i["g"])("h5",h," Pregunta "+Object(i["z"])(e.questionNumber+1)+":   "+Object(i["z"])(null===(Ee=e.requerimientos[e.stepIndex])||void 0===Ee?void 0:Ee.descripcion),1),Object(i["g"])("div",O,[x,Object(i["g"])("div",I,[R,Object(i["H"])(Object(i["g"])("input",{type:"radio",name:"totalmente",id:"1",value:"1","onUpdate:modelValue":t[4]||(t[4]=function(t){return e.evidenciaRequerimiento[e.stepIndex].respuestaItem=t})},null,512),[[i["C"],e.evidenciaRequerimiento[e.stepIndex].respuestaItem]])]),Object(i["g"])("div",q,[k,Object(i["H"])(Object(i["g"])("input",{type:"radio",name:"parcialmente",id:"0.5",value:"0.5","onUpdate:modelValue":t[5]||(t[5]=function(t){return e.evidenciaRequerimiento[e.stepIndex].respuestaItem=t})},null,512),[[i["C"],e.evidenciaRequerimiento[e.stepIndex].respuestaItem]])]),Object(i["g"])("div",w,[y,Object(i["H"])(Object(i["g"])("input",{type:"radio",name:"noimplementado",id:"0",value:"0","onUpdate:modelValue":t[6]||(t[6]=function(t){return e.evidenciaRequerimiento[e.stepIndex].respuestaItem=t})},null,512),[[i["C"],e.evidenciaRequerimiento[e.stepIndex].respuestaItem]])]),Object(i["g"])("div",C,[E,Object(i["H"])(Object(i["g"])("input",{type:"radio",name:"noaplica",id:"null",value:"null","onUpdate:modelValue":t[7]||(t[7]=function(t){return e.evidenciaRequerimiento[e.stepIndex].respuestaItem=t})},null,512),[[i["C"],e.evidenciaRequerimiento[e.stepIndex].respuestaItem]])])]),"null"!=e.evidenciaRequerimiento[e.stepIndex].respuestaItem?(Object(i["p"])(),Object(i["d"])("div",z,[S,Object(i["H"])(Object(i["g"])("input",{style:{"margin-left":"102px",width:"400px"},type:"text","onUpdate:modelValue":t[8]||(t[8]=function(t){return e.evidenciaRequerimiento[e.stepIndex].justificacion=t})},null,512),[[i["E"],e.evidenciaRequerimiento[e.stepIndex].justificacion]])])):Object(i["e"])("",!0),"null"!=e.evidenciaRequerimiento[e.stepIndex].respuestaItem?(Object(i["p"])(),Object(i["d"])("div",T,[D,N,Object(i["g"])("label",V,[Object(i["H"])(Object(i["g"])("input",{type:"checkbox",id:"checkbox",name:"nuevo","onUpdate:modelValue":t[9]||(t[9]=function(t){return e.nuevaEvidencia=t})},null,512),[[i["B"],e.nuevaEvidencia]]),$])])):Object(i["e"])("",!0),e.nuevaEvidencia?(Object(i["p"])(),Object(i["d"])("div",H,["null"!=e.evidenciaRequerimiento[e.stepIndex].respuestaItem?(Object(i["p"])(),Object(i["d"])("div",L,[P,Object(i["H"])(Object(i["g"])("input",{style:{"margin-left":"20px",width:"300px"},type:"text","onUpdate:modelValue":t[10]||(t[10]=function(t){return e.evidencia[e.stepIndex].nombre=t})},null,512),[[i["E"],e.evidencia[e.stepIndex].nombre]])])):Object(i["e"])("",!0),"null"!=e.evidenciaRequerimiento[e.stepIndex].respuestaItem?(Object(i["p"])(),Object(i["d"])("div",A,[B,Object(i["g"])("div",J,[Object(i["g"])("label",U,Object(i["z"])(e.uploadText),1),Object(i["g"])("input",{id:"files",style:{visibility:"hidden"},type:"file",onChange:t[11]||(t[11]=function(t){return e.fileChange(t.target.files)})},null,32),_])])):Object(i["e"])("",!0)])):(Object(i["p"])(),Object(i["d"])("div",F,["null"!=e.evidenciaRequerimiento[e.stepIndex].respuestaItem?(Object(i["p"])(),Object(i["d"])("div",M,[G,Object(i["g"])("div",Q,[Object(i["H"])(Object(i["g"])("input",{type:"text",placeholder:"Buscar por código",onKeyup:t[12]||(t[12]=function(){return e.fetchEvidencias&&e.fetchEvidencias.apply(e,arguments)}),"onUpdate:modelValue":t[13]||(t[13]=function(t){return e.evidencia[e.stepIndex].codigoEvidencia=t}),style:{"margin-left":"-3px"}},null,544),[[i["E"],e.evidencia[e.stepIndex].codigoEvidencia,void 0,{trim:!0}]]),Object(i["g"])("p",K,Object(i["z"])(e.evidencia[e.stepIndex].adjunto),1),Object(i["g"])("div",W,[(Object(i["p"])(!0),Object(i["d"])(i["a"],null,Object(i["v"])(e.evidenciasFetched,(function(t){return Object(i["p"])(),Object(i["d"])("p",{class:"dropdownSelect",key:t.evidenciaId,onClick:function(n){return e.selectEvidencia(t)}},Object(i["z"])(t.codigo+"-"+t.nombre),9,["onClick"])})),128))])])])):Object(i["e"])("",!0)]))])):Object(i["e"])("",!0),e.questionNumber>0&&!e.showResultado?(Object(i["p"])(),Object(i["d"])("button",{key:3,class:"action-button main-form left",onClick:t[14]||(t[14]=function(){return e.previous&&e.previous.apply(e,arguments)})}," Anterior ")):Object(i["e"])("",!0),e.start&&!e.showResultado?(Object(i["p"])(),Object(i["d"])("button",{key:4,class:"action-button main-form",onClick:t[15]||(t[15]=function(){return e.next&&e.next.apply(e,arguments)})},Object(i["z"])(e.end?"Finalizar":"Continuar"),1)):Object(i["e"])("",!0),e.showResultado?(Object(i["p"])(),Object(i["d"])("div",X,[Object(i["g"])("div",Y,[Object(i["g"])("div",Z,[Object(i["g"])("table",ee,[te,Object(i["g"])("tbody",null,[(Object(i["p"])(!0),Object(i["d"])(i["a"],null,Object(i["v"])(e.pruebaResultados.criteriosResultado.length,(function(t,n){return Object(i["p"])(),Object(i["d"])("tr",{key:t},[Object(i["g"])("td",null,Object(i["z"])(e.pruebaResultados.criteriosResultado[n].descripcion+" ("+e.pruebaResultados.criteriosResultado[n].peso+") "),1),Object(i["g"])("td",null,[ne,ie,ae,ce,oe,re,se,ue,de,Object(i["f"])(" "+Object(i["z"])(e.pruebaResultados.criteriosResultado[n].normalizedPuntaje),1)]),Object(i["g"])("td",null,[le,pe,be,ve,me,ge,Object(i["f"])(" "+Object(i["z"])(e.pruebaResultados.criteriosResultado[n].porcentajeCumplimiento+"%"),1)])])})),128))])])]),Object(i["g"])("div",je,[Object(i["g"])("div",fe,[he,Object(i["g"])("table",Oe,[Object(i["g"])("tbody",null,[Object(i["g"])("tr",null,[xe,Object(i["g"])("td",null,Object(i["z"])(e.pruebaResultados.porcentajeCumplimientoTotal)+"%",1)]),Object(i["g"])("tr",null,[Ie,Object(i["g"])("td",null,Object(i["z"])(e.pruebaResultados.nivelDeRiesgo),1)])]),Object(i["g"])("button",{class:"action-button main-form left final",onClick:t[16]||(t[16]=function(){return e.showSummary&&e.showSummary.apply(e,arguments)})}," Visualizar resumen "),Object(i["g"])("button",{class:"action-button main-form final",onClick:t[17]||(t[17]=function(){return e.submit&&e.submit.apply(e,arguments)})}," Guardar prueba ")])])])])])):Object(i["e"])("",!0)])],64)})),qe=n("b85c"),ke=n("5530"),we=n("1da1"),ye=(n("96cf"),n("d3b7"),n("ac1f"),n("5319"),n("99af"),n("b0c0"),n("25f0"),n("4e82"),n("d81d"),n("4ec9"),n("3ca3"),n("ddb0"),n("4de4"),n("7db0"),n("159b"),n("f464")),Ce=n("5c40"),Ee=n("2fc2"),ze=n("b74e"),Se=n("705f"),Te=n("f50d"),De=n("d43e"),Ne=Object(Ce["l"])({components:{NavBar:ye["a"],Modal:Se["a"]},computed:{selectedListaVerificacion:function(){return this.$store.getters["listaVerificacionModule/selectedListaVerificacion"]},prueba:function(){return this.$store.getters["pruebaModule/obtenerPrueba"]},evaluacion:function(){return this.$store.getters["evaluacionModule/obtenerEvaluacion"]}},data:function(){return{userInfoJson:Object(De["h"])(),date:(new Date).toLocaleDateString(),start:!1,criterios:[],requerimientos:[],evidenciaRequerimiento:[],evidencia:[],evidenciasFetched:[],pruebaResultados:{},obraId:"",criterioIndex:0,stepIndex:0,questionNumber:0,end:!1,showResultado:!1,loading:!1,error:!1,message:"",evaluacionDetalle:{},files:new FormData,uploadText:"Adjuntar archivo",nuevaEvidencia:!1,lastEvidenciaCodigo:"",timeout:void 0,hasSelectedEvidencia:!1}},methods:{selectEvidencia:function(e){this.hasSelectedEvidencia=!0,this.evidenciasFetched=[],this.evidencia[this.stepIndex]=e,this.evidencia[this.stepIndex].codigoEvidencia=e.codigo+"-"+e.nombre},changeUploadInterface:function(){this.nuevaEvidencia=!this.nuevaEvidencia},backToEvluacion:function(){this.$router.push("/evaluacion/".concat(this.evaluacion.codigo))},startQuiz:function(){var e=this;return Object(we["a"])(regeneratorRuntime.mark((function t(){var n,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={EvaluacionId:e.evaluacion.evaluacionId,Codigo:e.prueba.codigo},t.prev=1,t.next=4,fetch("".concat(Ee["c"],"prueba"),{method:"POST",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}),body:JSON.stringify(n)});case 4:return a=t.sent,t.next=7,a.json();case 7:i=t.sent,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](1),console.log(t.t0);case 13:e.$router.replace({path:"/evaluacion/".concat(e.evaluacion.codigo,"/prueba/").concat(i.codigo),query:{req:1}}),e.start=!0;case 15:case"end":return t.stop()}}),t,null,[[1,10]])})))()},obtenerPruebaResults:function(){var e=this;return Object(we["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(Ee["c"],"prueba/").concat(e.prueba.codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return n=t.sent,t.next=6,Object(ze["a"])(n);case 6:return t.next=8,n.json();case 8:e.pruebaResultados=t.sent,t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),e.error=!0,JSON.parse(t.t0.message);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))()},registrarEvidenciaRequerimiento:function(){var e=this;return Object(we["a"])(regeneratorRuntime.mark((function t(){var n,i,a,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,"null"===e.evidenciaRequerimiento[e.stepIndex].respuestaItem&&(e.evidenciaRequerimiento[e.stepIndex].justificacion="",e.evidencia[e.stepIndex].nombre=""),e.evidencia[e.stepIndex].evidenciaId||""==e.evidencia[e.stepIndex].nombre||null==e.evidencia[e.stepIndex].nombre){t.next=7;break}return t.next=5,e.evidenciasCount();case 5:e.evidencia[e.stepIndex].codigo=e.lastEvidenciaCodigo,e.evidencia[e.stepIndex].codigoEvidencia=e.evidencia[e.stepIndex].codigo+"-"+e.evidencia[e.stepIndex].nombre;case 7:return n={EvidenciaId:e.evidencia[e.stepIndex].evidenciaId?e.evidencia[e.stepIndex].evidenciaId:null,RequerimientoId:e.requerimientos[e.stepIndex].requerimientoId,PruebaCodigo:e.$route.params.pr_codigo,EvidenciaNombre:e.evidencia[e.stepIndex].nombre,EvidenciaCodigo:e.evidencia[e.stepIndex].codigo,Justificacion:e.evidenciaRequerimiento[e.stepIndex].justificacion,RespuestaItem:JSON.parse(e.evidenciaRequerimiento[e.stepIndex].respuestaItem)},t.next=10,fetch("".concat(Ee["c"],"evidenciarequerimiento"),{method:"POST",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}),body:JSON.stringify(n)});case 10:return i=t.sent,t.next=13,Object(ze["a"])(i);case 13:return t.next=15,i.json();case 15:if(a=t.sent,a.evidenciaId&&(e.evidencia[e.stepIndex].evidenciaId=a.evidenciaId),t.t0=a.evidenciaId,!t.t0){t.next=21;break}return t.next=21,e.upload(a.evidenciaId);case 21:t.next=29;break;case 23:t.prev=23,t.t1=t["catch"](0),e.error=!0,console.log(t.t1),c=JSON.parse(t.t1.message),console.log(c.errores);case 29:case"end":return t.stop()}}),t,null,[[0,23]])})))()},next:function(){var e=this;return Object(we["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.registrarEvidenciaRequerimiento();case 3:if(!e.end){t.next=12;break}return e.stepIndex=0,t.next=7,e.obtenerPruebaResults();case 7:e.showResultado=!0,e.loading=!1,e.$router.push("/evaluacion/".concat(e.evaluacion.codigo,"/prueba/").concat(e.$route.params.pr_codigo,"/resumen")),t.next=23;break;case 12:if(!e.evidencia[e.stepIndex+1]&&e.evidencia.push(Object(De["c"])()),!e.evidenciaRequerimiento[e.stepIndex+1]&&e.evidenciaRequerimiento.push(Object(De["d"])()),e.requerimientos[e.stepIndex+2]||(e.end=!0),!e.requerimientos[e.stepIndex+1]){t.next=19;break}e.stepIndex+=1,t.next=21;break;case 19:return e.loading=!1,t.abrupt("return");case 21:e.questionNumber+=1,e.$router.push({path:"/evaluacion/".concat(e.evaluacion.codigo,"/prueba/").concat(e.$route.params.pr_codigo),query:{req:e.questionNumber+1}});case 23:e.files=new FormData,e.loading=!1,e.hasSelectedEvidencia=!1,e.nuevaEvidencia=!1;case 27:case"end":return t.stop()}}),t)})))()},previous:function(){this.requerimientos[this.stepIndex-1]&&(this.stepIndex-=1,this.questionNumber-=1,this.end=!1,this.hasSelectedEvidencia=!1,this.nuevaEvidencia=!1,this.$router.replace({path:"/evaluacion/".concat(this.evaluacion.codigo,"/prueba/").concat(this.$route.params.pr_codigo),query:{req:this.questionNumber+1}}))},showSummary:function(){this.$router.push("/lista-verificacion/".concat(this.selectedListaVerificacion.codigo,"/prueba/").concat(this.$route.params.pr_codigo,"/resumen"))},submit:function(){var e=this;Object(we["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(Ee["c"],"prueba/activar/").concat(e.prueba.codigo),{method:"PUT",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),console.log(t.t0);case 8:e.$router.push("/evaluacion/"+e.evaluacion.codigo);case 9:case"end":return t.stop()}}),t,null,[[0,5]])})))()},fileChange:function(e){this.files=new FormData,this.evidencia[this.stepIndex].evidenciaId=void 0,this.files.append("file",e[0],e[0].name),this.uploadText=e[0].name},upload:function(e){var t=this;return Object(we["a"])(regeneratorRuntime.mark((function n(){var i,a,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,i=t.files,n.next=4,fetch("".concat(Ee["c"],"evidencia/upload/").concat(e),{method:"POST",headers:new Headers({Authorization:"Bearer "+localStorage.getItem("token")}),body:i});case 4:return a=n.sent,n.next=7,a.json();case 7:c=n.sent,console.log(c,t.evidencia[t.stepIndex].evidenciaId),t.evidencia[t.stepIndex].evidenciaId&&c&&(t.evidencia[t.stepIndex]=Object(ke["a"])(Object(ke["a"])({},t.evidencia[t.stepIndex]),c)),t.files=new FormData,t.uploadText="Adjuntar archivo",n.next=17;break;case 14:n.prev=14,n.t0=n["catch"](0),console.log(n.t0);case 17:case"end":return n.stop()}}),n,null,[[0,14]])})))()},fetchEvidencias:function(){var e=this;return Object(we["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:clearTimeout(e.timeout),e.timeout=setTimeout(Object(we["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(Ee["c"],"evidencia/lista?filter=").concat(e.evidencia[e.stepIndex].codigoEvidencia),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return n=t.sent,t.next=6,Object(ze["a"])(n);case 6:return t.next=8,n.json();case 8:e.evidenciasFetched=t.sent,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])}))),1e3);case 2:case"end":return t.stop()}}),t)})))()},evidenciasCount:function(){var e=this;return Object(we["a"])(regeneratorRuntime.mark((function t(){var n,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(Ee["c"],"evidencia/count"),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return n=t.sent,t.next=6,n.json();case 6:i=t.sent,a="",a=i>=99?"":i>=9?"0":"00",e.lastEvidenciaCodigo="ED"+a+(i+1).toString(),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()}},mounted:function(){var e=this;Object(we["a"])(regeneratorRuntime.mark((function t(){var n,i,a,c,o,r,s,u,d,l,p,b,v;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(Te["a"])();case 2:return e.userInfoJson=t.sent,t.next=5,e.evidenciasCount();case 5:return n=[],t.prev=6,t.next=9,fetch("".concat(Ee["c"],"evaluacion/").concat(e.$route.params.ev_codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 9:if(i=t.sent,"No Content"===i.statusText){t.next=19;break}return t.next=13,i.json();case 13:e.evaluacionDetalle=t.sent,e.selectedListaVerificacion.fechaCreacion=e.evaluacionDetalle.listaVerificacionFechaCreacion,e.selectedListaVerificacion.requerimientosCount=e.evaluacionDetalle.requerimientosCount,e.selectedListaVerificacion.codigo=e.evaluacionDetalle.codigoListaVerificacion,e.obraId=e.evaluacionDetalle.obraId,e.$store.dispatch("evaluacionModule/guardarEvaluacion",Object(ke["a"])(Object(ke["a"])({},e.evaluacion),{},{evaluacionId:e.evaluacionDetalle.evaluacionId,codigo:e.evaluacionDetalle.codigo,nombre:e.evaluacionDetalle.nombre,estado:e.evaluacionDetalle.estado,visibilidad:e.evaluacionDetalle.visibilidad,fechaCreacion:new Date(e.evaluacionDetalle.fechaCreacion).toLocaleDateString()}));case 19:t.next=24;break;case 21:t.prev=21,t.t0=t["catch"](6),console.log(t.t0);case 24:return t.prev=24,t.next=27,fetch("".concat(Ee["c"],"listaverificaciones/lista?filter=").concat(e.evaluacionDetalle.codigoListaVerificacion),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 27:return a=t.sent,t.next=30,a.json();case 30:n=t.sent,e.$store.dispatch("listaVerificacionModule/guardarListaVerificacion",Object(ke["a"])({},n[0])),c=n[0].requerimientos.map((function(e){return e.criterio})).sort((function(e,t){return e.descripcion.localeCompare(t.descripcion)})),o=new Map,r=Object(qe["a"])(c);try{for(r.s();!(s=r.n()).done;)u=s.value,o.has(u.descripcion)||(o.set(u.descripcion,!0),e.criterios.push(u))}catch(m){r.e(m)}finally{r.f()}e.requerimientos=e.selectedListaVerificacion.requerimientos.sort((function(e,t){return e.criterio.descripcion.localeCompare(t.criterio.descripcion)})),e.evidencia.push(Object(De["c"])()),e.evidencia[0].codigo=e.lastEvidenciaCodigo,e.evidenciaRequerimiento.push(Object(De["d"])()),t.next=45;break;case 42:t.prev=42,t.t1=t["catch"](24),console.log(t.t1);case 45:if(void 0!=e.$route.params.pr_codigo){t.next=63;break}return t.prev=46,t.next=49,fetch("".concat(Ee["c"],"prueba/count"),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 49:return d=t.sent,t.next=52,d.json();case 52:l=t.sent,p="",p=l>10?"0":"00",e.$store.dispatch("pruebaModule/guardarPrueba",Object(ke["a"])(Object(ke["a"])({},e.prueba),{},{codigo:"PR"+p+(l+1).toString()})),t.next=61;break;case 58:t.prev=58,t.t2=t["catch"](46),console.log(t.t2);case 61:t.next=81;break;case 63:return e.$store.dispatch("pruebaModule/guardarPrueba",Object(ke["a"])(Object(ke["a"])({},e.prueba),{},{codigo:e.$route.params.pr_codigo})),t.prev=64,t.next=67,fetch("".concat(Ee["c"],"evidenciarequerimiento/").concat(e.$route.params.pr_codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 67:return b=t.sent,t.next=70,b.json();case 70:v=t.sent,v.length>0&&(e.evidencia=[],e.evidenciaRequerimiento=[],v=e.requerimientos.map((function(e){return v.find((function(t){return t.requerimientoId==e.requerimientoId}))})).filter((function(e){return void 0!==e})),v.forEach((function(t){var n,i,a,c,o,r,s,u;e.evidencia.push({evidenciaId:null===(n=t.evidencia)||void 0===n?void 0:n.evidenciaId,codigo:null===(i=t.evidencia)||void 0===i?void 0:i.codigo,nombre:null===(a=t.evidencia)||void 0===a?void 0:a.nombre,adjunto:null===(c=t.evidencia)||void 0===c?void 0:c.adjunto,codigoEvidencia:null!==(o=t.evidencia)&&void 0!==o&&o.codigo&&null!==(r=t.evidencia)&&void 0!==r&&r.nombre?t.evidencia.codigo+"-"+(null===(s=t.evidencia)||void 0===s?void 0:s.nombre):"",adjuntoURL:null===(u=t.evidencia)||void 0===u?void 0:u.adjuntoURL}),e.evidenciaRequerimiento.push({evidenciaId:t.evidenciaId,requerimientoId:t.requerimientoId,pruebaId:t.pruebaId,justificacion:t.justificacion,respuestaItem:t.respuestaItem,recomendacion:t.recomendacion})}))),v.length>0?(e.stepIndex=v.length-1,e.questionNumber=v.length-1):(e.stepIndex=0,e.questionNumber=0),e.requerimientos.length==v.length&&(e.end=!0),e.$router.replace({path:"/evaluacion/".concat(e.evaluacion.codigo,"/prueba/").concat(e.$route.params.pr_codigo),query:{req:e.questionNumber+1}}),e.start=!0,t.next=81;break;case 78:t.prev=78,t.t3=t["catch"](64),console.log(t.t3);case 81:case"end":return t.stop()}}),t,null,[[6,21],[24,42],[46,58],[64,78]])})))()},unmounted:function(){this.start=!1,this.criterioIndex=0,this.stepIndex=0,this.questionNumber=0,this.end=!1,this.showResultado=!1}});n("f8fe");Ne.render=Re,Ne.__scopeId="data-v-d83030a2";t["default"]=Ne},f8fe:function(e,t,n){"use strict";n("6a19")}}]);
//# sourceMappingURL=chunk-365b5d01.ab002e5e.js.map