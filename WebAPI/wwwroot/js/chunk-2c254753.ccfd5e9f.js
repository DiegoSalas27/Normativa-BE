(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c254753"],{5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var i=n("1d80"),a=n("5899"),r="["+a+"]",o=RegExp("^"+r+r+"*"),c=RegExp(r+r+"*$"),u=function(e){return function(t){var n=String(i(t));return 1&e&&(n=n.replace(o,"")),2&e&&(n=n.replace(c,"")),n}};e.exports={start:u(1),end:u(2),trim:u(3)}},"699d":function(e,t,n){},"71ad":function(e,t,n){"use strict";n.r(t);var i=n("7a23"),a=Object(i["J"])("data-v-bf6c9fe2");Object(i["s"])("data-v-bf6c9fe2");var r={id:"main"},o=Object(i["g"])("i",{class:"fas fa-chevron-circle-left"},null,-1),c=Object(i["f"])(" Volver "),u=Object(i["g"])("br",null,null,-1),s={key:0,class:"flex-row"},d=Object(i["g"])("h4",{style:{display:"inline"}}," Ingrese el porcentaje de cumplimiento deseado: ",-1),l=Object(i["g"])("h4",{style:{display:"inline"}},"Porcentaje actual:",-1),m=Object(i["f"])("    "),p={class:"options-buttons"},b={class:"summary"},f={class:"header-summary"},v={class:"summary-body"},g={class:"body-item-header flex-row",style:{paddingbottom:"20px",paddingtop:"20px"}},j={style:{width:"70%"}},h={style:{marginleft:"5px"}},O={class:"body-item-content",style:{paddingbottom:"20px"}},x={class:"flex-row"},I=Object(i["g"])("p",null,"Justificación:",-1),y=Object(i["g"])("div",null,[Object(i["g"])("i",{class:"far fa-file-pdf"}),Object(i["g"])("span",{style:{textdecoration:"underline",cursor:"pointer"}},"Descargar evidencia")],-1),C=Object(i["g"])("br",null,null,-1),w={key:0,class:"flex-row"},q=Object(i["g"])("p",null,"Recomendación:",-1),k=Object(i["g"])("br",null,null,-1);Object(i["q"])();var R=a((function(e,t,n,a,R,E){var N,S,T=Object(i["x"])("nav-bar"),M=Object(i["x"])("modal");return Object(i["p"])(),Object(i["d"])(i["a"],null,[Object(i["g"])(T,{name:null===(N=e.userInfoJson)||void 0===N?void 0:N.nombres,lastName:null===(S=e.userInfoJson)||void 0===S?void 0:S.apellidos},null,8,["name","lastName"]),Object(i["g"])(M,{show:!!e.message,title:e.message,onClose:e.handleError,error:e.error,loading:e.loading},null,8,["show","title","onClose","error","loading"]),Object(i["g"])("section",r,[Object(i["g"])("h1",{style:{textAlign:"left",cursor:"pointer"},onClick:t[1]||(t[1]=function(){return e.back&&e.back.apply(e,arguments)})},[o,c]),u,e.canEdit?(Object(i["p"])(),Object(i["d"])("div",s,[Object(i["g"])("div",null,[d,Object(i["g"])("input",{class:"percentage",type:"number",min:e.porcentajeCumplimiento,onChange:t[2]||(t[2]=function(){return e.setValue&&e.setValue.apply(e,arguments)}),value:e.porcentajeCumplimientoDeseado},null,40,["min","value"])]),Object(i["g"])("div",null,[l,m,Object(i["g"])("span",null,Object(i["z"])(e.porcentajeCumplimiento)+"%",1)]),Object(i["g"])("div",p,[Object(i["g"])("button",{class:"action-button",onClick:t[3]||(t[3]=function(){return e.summary&&e.summary.apply(e,arguments)})},"Resumen"),Object(i["g"])("button",{class:["action-button",e.porcentajeCumplimientoDeseado<e.porcentajeCumplimiento?"action-button blocked":"action-button"],onClick:t[4]||(t[4]=function(){return e.idealScenario&&e.idealScenario.apply(e,arguments)}),disabled:e.porcentajeCumplimientoDeseado<e.porcentajeCumplimiento}," Escenario deseado ",10,["disabled"])])])):Object(i["e"])("",!0),Object(i["g"])("div",b,[Object(i["g"])("div",f,[Object(i["g"])("h1",null,Object(i["z"])(e.headingTitle),1)]),Object(i["g"])("div",v,[(Object(i["p"])(!0),Object(i["d"])(i["a"],null,Object(i["v"])(e.requerimientos,(function(t,n){var a,r,o,c,u,s,d;return Object(i["p"])(),Object(i["d"])("div",{class:"body-item",key:t.requerimientoId},[Object(i["g"])("div",g,[Object(i["g"])("h3",null,"Pregunta "+Object(i["z"])(t.posicion?t.posicion:n+1)+":",1),Object(i["g"])("span",j,Object(i["z"])(t.descripcion),1),Object(i["g"])("span",h,Object(i["z"])(e.respuestaItem(n)),1)]),Object(i["g"])("div",O,[Object(i["g"])("div",x,[I,Object(i["g"])("textarea",{name:"justificacion",id:"justi",cols:"80",rows:"5",style:{width:"71.5%"},disabled:"true",value:null===(a=e.evidenciaRequerimiento[n])||void 0===a?void 0:a.justificacion},null,8,["value"]),y]),C,e.evidenciaRequerimiento[n]?(Object(i["p"])(),Object(i["d"])("div",w,[q,Object(i["H"])(Object(i["g"])("textarea",{name:"recomendacion",id:"recom",cols:"120",rows:"5",style:{width:"75%"},disabled:"true","onUpdate:modelValue":function(t){return e.evidenciaRequerimiento[n].recomendacion=t}},null,8,["onUpdate:modelValue"]),[[i["E"],e.evidenciaRequerimiento[n].recomendacion]]),null!=(null===(r=e.evidenciaRequerimiento[n])||void 0===r?void 0:r.respuestaItem)&&1!=(null===(o=e.evidenciaRequerimiento[n])||void 0===o?void 0:o.respuestaItem)&&e.canEdit?(Object(i["p"])(),Object(i["d"])("button",{key:0,class:null==(null===(c=e.evidenciaRequerimiento[n])||void 0===c?void 0:c.respuestaItem)||1==(null===(u=e.evidenciaRequerimiento[n])||void 0===u?void 0:u.respuestaItem)||null!==(s=e.evidenciaRequerimiento[n])&&void 0!==s&&s.accionMigitagcion?"action-button thin blocked":"action-button thin",onClick:function(t){return e.saveRecomendacion(n)},disabled:null===(d=e.evidenciaRequerimiento[n])||void 0===d?void 0:d.accionMigitagcion}," Añadir ("+Object(i["z"])(e.accionesMitigacionCreadas)+") ",11,["onClick","disabled"])):Object(i["e"])("",!0)])):Object(i["e"])("",!0),k])])})),128))])])])],64)})),E=n("b85c"),N=n("1da1"),S=(n("96cf"),n("a9e3"),n("d3b7"),n("25f0"),n("99af"),n("4de4"),n("d81d"),n("7db0"),n("159b"),n("4e82"),n("4ec9"),n("3ca3"),n("ddb0"),n("5c40")),T=n("f464"),M=n("d43e"),A=n("f50d"),_=n("b74e");n("ac1f"),n("5319");function z(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)}))}var J=n("705f"),D=n("2fc2"),V=Object(S["l"])({components:{NavBar:T["a"],Modal:J["a"]},data:function(){return{userInfoJson:Object(M["h"])(),headingTitle:"Resumen",evidencia:[],evidenciaRequerimiento:[],requerimientos:[],criterios:[],porcentajeCumplimiento:0,porcentajeCumplimientoDeseado:0,accionesMitigacionCreadas:0,message:null,loading:!1,error:!1,canEdit:!1}},methods:{handleError:function(){this.message=null},setValue:function(e){Number(e.target.value)<this.porcentajeCumplimiento&&(e.target.value=this.porcentajeCumplimiento.toString()),this.porcentajeCumplimientoDeseado=+e.target.value},back:function(){this.$router.back()},summary:function(){var e=this;return Object(N["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.realScenario();case 2:case"end":return t.stop()}}),t)})))()},idealScenario:function(){var e=this;return Object(N["a"])(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.porcentajeCumplimientoDeseado<e.porcentajeCumplimiento)){t.next=2;break}return t.abrupt("return");case 2:return e.message="Cargando...",t.prev=3,t.next=6,fetch("".concat(D["c"],"prueba/").concat(e.$route.params.pr_codigo,"/").concat(e.porcentajeCumplimientoDeseado),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 6:return n=t.sent,t.next=9,Object(_["a"])(n);case 9:return t.next=11,n.json();case 11:i=t.sent,e.requerimientos=e.requerimientos.filter((function(e,t){return i.some((function(n){if(n.requerimientoId==e.requerimientoId)return e.posicion=t+1,!0}))})),i.length>0&&(e.evidencia=[],e.evidenciaRequerimiento=[],i=e.requerimientos.map((function(e){return i.find((function(t){return t.requerimientoId==e.requerimientoId}))})).filter((function(e){return void 0!==e})),i.forEach((function(t){var n,i,a;e.evidencia.push({evidenciaId:null===(n=t.evidencia)||void 0===n?void 0:n.evidenciaId,nombre:null===(i=t.evidencia)||void 0===i?void 0:i.nombre,adjunto:null===(a=t.evidencia)||void 0===a?void 0:a.adjunto}),e.evidenciaRequerimiento.push({evidenciaId:t.evidenciaId,requerimientoId:t.requerimientoId,pruebaId:t.pruebaId,justificacion:t.justificacion,respuestaItem:t.respuestaItem,recomendacion:t.recomendacion,tratamientoId:t.tratamientoId,tratamientoCodigo:t.tratamientoCodigo,accionMigitagcion:t.accionMigitagcion})}))),e.headingTitle="Escenario deseado",e.message="",t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](3),console.log(t.t0);case 21:case"end":return t.stop()}}),t,null,[[3,18]])})))()},realScenario:function(){var e=this;return Object(N["a"])(regeneratorRuntime.mark((function t(){var n,i,a,r,o,c,u,s,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.message="Cargando...",t.prev=1,t.next=4,fetch("".concat(D["c"],"listaverificaciones/lista?filter=").concat(e.$route.params.lv_codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 4:return n=t.sent,t.next=7,n.json();case 7:i=t.sent,a=i[0].requerimientos.map((function(e){return e.criterio})).sort((function(e,t){return e.descripcion.localeCompare(t.descripcion)})),r=new Map,o=Object(E["a"])(a);try{for(o.s();!(c=o.n()).done;)u=c.value,r.has(u.descripcion)||(r.set(u.descripcion,!0),e.criterios.push(u))}catch(l){o.e(l)}finally{o.f()}e.requerimientos=i[0].requerimientos.sort((function(e,t){return e.criterio.descripcion.localeCompare(t.criterio.descripcion)})),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](1),console.log(t.t0);case 18:return t.prev=18,t.next=21,fetch("".concat(D["c"],"evidenciarequerimiento/").concat(e.$route.params.pr_codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 21:return s=t.sent,t.next=24,s.json();case 24:d=t.sent,console.log(d),e.porcentajeCumplimiento=d[0].pruebaPorcentajeCumplimiento,e.accionesMitigacionCreadas=d.filter((function(e){return e.accionMigitagcion})).length,d.length>0&&(e.evidencia=[],e.evidenciaRequerimiento=[],d=e.requerimientos.map((function(e){return d.find((function(t){return t.requerimientoId==e.requerimientoId}))})).filter((function(e){return void 0!==e})),d.forEach((function(t){var n,i,a;e.evidencia.push({evidenciaId:null===(n=t.evidencia)||void 0===n?void 0:n.evidenciaId,nombre:null===(i=t.evidencia)||void 0===i?void 0:i.nombre,adjunto:null===(a=t.evidencia)||void 0===a?void 0:a.adjunto}),e.evidenciaRequerimiento.push({evidenciaId:t.evidenciaId,requerimientoId:t.requerimientoId,pruebaId:t.pruebaId,justificacion:t.justificacion,respuestaItem:t.respuestaItem,recomendacion:t.recomendacion,tratamientoId:t.tratamientoId,tratamientoCodigo:t.tratamientoCodigo,accionMigitagcion:t.accionMigitagcion})}))),e.headingTitle="Resumen",e.message="",t.next=36;break;case 33:t.prev=33,t.t1=t["catch"](18),console.log(t.t1);case 36:case"end":return t.stop()}}),t,null,[[1,15],[18,33]])})))()},respuestaItem:function(e){var t,n="No implementado";switch(null===(t=this.evidenciaRequerimiento[e])||void 0===t?void 0:t.respuestaItem){case 1:n="Totalmente";break;case.5:n="Parcialmente";break;case 0:n="No implementado";break;case null:n="No aplica";break;default:break}return n},saveRecomendacion:function(e){var t=this;return Object(N["a"])(regeneratorRuntime.mark((function n(){var i,a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=t.evidenciaRequerimiento[e],a={TratamientoId:i.tratamientoId,AccionMitigacionId:z(),Descripcion:t.requerimientos[e].descripcion,Estado:!1},n.prev=2,n.next=5,fetch("".concat(D["c"],"evidenciarequerimiento/").concat(i.evidenciaId,"/").concat(i.pruebaId,"/").concat(i.requerimientoId),{method:"PUT",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}),body:JSON.stringify(a)});case 5:return r=n.sent,n.next=8,Object(_["a"])(r);case 8:t.evidenciaRequerimiento[e].accionMigitagcion=!0,t.accionesMitigacionCreadas++,n.next=15;break;case 12:n.prev=12,n.t0=n["catch"](2),console.log(n.t0);case 15:case"end":return n.stop()}}),n,null,[[2,12]])})))()}},mounted:function(){var e=this;Object(N["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(A["a"])();case 2:return e.userInfoJson=t.sent,e.userInfoJson.rol==D["i"].JEFE_DE_RIESGOS?e.canEdit=!0:e.canEdit=!1,t.next=6,e.realScenario();case 6:case"end":return t.stop()}}),t)})))()}});n("b9bd");V.render=R,V.__scopeId="data-v-bf6c9fe2";t["default"]=V},a9e3:function(e,t,n){"use strict";var i=n("83ab"),a=n("da84"),r=n("94ca"),o=n("6eeb"),c=n("5135"),u=n("c6b6"),s=n("7156"),d=n("c04e"),l=n("d039"),m=n("7c73"),p=n("241c").f,b=n("06cf").f,f=n("9bf2").f,v=n("58a8").trim,g="Number",j=a[g],h=j.prototype,O=u(m(h))==g,x=function(e){var t,n,i,a,r,o,c,u,s=d(e,!1);if("string"==typeof s&&s.length>2)if(s=v(s),t=s.charCodeAt(0),43===t||45===t){if(n=s.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(s.charCodeAt(1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+s}for(r=s.slice(2),o=r.length,c=0;c<o;c++)if(u=r.charCodeAt(c),u<48||u>a)return NaN;return parseInt(r,i)}return+s};if(r(g,!j(" 0o1")||!j("0b1")||j("+0x1"))){for(var I,y=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof y&&(O?l((function(){h.valueOf.call(n)})):u(n)!=g)?s(new j(x(t)),n,y):x(t)},C=i?p(j):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),w=0;C.length>w;w++)c(j,I=C[w])&&!c(y,I)&&f(y,I,b(j,I));y.prototype=h,h.constructor=y,o(a,g,y)}},b9bd:function(e,t,n){"use strict";n("699d")},f50d:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("1da1"),a=(n("96cf"),n("d3b7"),n("2fc2"));function r(){return o.apply(this,arguments)}function o(){return o=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(a["c"],"usuario"),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)}}}]);
//# sourceMappingURL=chunk-2c254753.ccfd5e9f.js.map