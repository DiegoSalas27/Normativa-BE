(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ee915058"],{"13ab":function(e,t,n){},"25f0":function(e,t,n){"use strict";var i=n("6eeb"),a=n("825a"),r=n("d039"),o=n("ad6d"),c="toString",u=RegExp.prototype,s=u[c],d=r((function(){return"/a/b"!=s.call({source:"a",flags:"b"})})),l=s.name!=c;(d||l)&&i(RegExp.prototype,c,(function(){var e=a(this),t=String(e.source),n=e.flags,i=String(void 0===n&&e instanceof RegExp&&!("flags"in u)?o.call(e):n);return"/"+t+"/"+i}),{unsafe:!0})},"2dd4":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("ac1f"),n("5319"),n("d3b7"),n("25f0");function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)}))}},"562b":function(e,t,n){},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var i=n("1d80"),a=n("5899"),r="["+a+"]",o=RegExp("^"+r+r+"*"),c=RegExp(r+r+"*$"),u=function(e){return function(t){var n=String(i(t));return 1&e&&(n=n.replace(o,"")),2&e&&(n=n.replace(c,"")),n}};e.exports={start:u(1),end:u(2),trim:u(3)}},"71ad":function(e,t,n){"use strict";n.r(t);var i=n("7a23"),a=Object(i["W"])("data-v-48489d1f");Object(i["E"])("data-v-48489d1f");var r={id:"main"},o=Object(i["m"])("i",{class:"fas fa-chevron-circle-left"},null,-1),c=Object(i["l"])(" Volver "),u=Object(i["m"])("br",null,null,-1),s={key:0,style:{display:"flex","align-items":"center","justify-content":"space-between"}},d=Object(i["m"])("h4",{style:{display:"inline"}}," Ingrese el porcentaje de cumplimiento deseado: ",-1),l=Object(i["m"])("i",{class:"fas fa-info-circle"},null,-1),m={class:"grid"},p=Object(i["m"])("thead",{class:"header-grid"},[Object(i["m"])("tr",null,[Object(i["m"])("th",null,"Nivel de riesgo"),Object(i["m"])("th",null,"Porcentaje de cumplimiento actual")])],-1),b={class:"options-buttons",style:{display:"flex","align-items":"center"}},v={class:"summary"},f={class:"header-summary"},j={class:"summary-body"},g={class:"body-item-header flex-row",style:{paddingbottom:"20px",paddingtop:"20px"}},h={style:{width:"70%"}},O={style:{marginleft:"5px"}},x={class:"body-item-content",style:{paddingbottom:"20px"}},I={class:"flex-row",style:{"justify-content":"flex-start",gap:"20px"}},y=Object(i["m"])("p",null,"Justificación:",-1),R=Object(i["m"])("i",{class:"far fa-file-pdf"},null,-1),w=Object(i["m"])("br",null,null,-1),C={key:0,class:"flex-row",style:{"justify-content":"flex-start",gap:"20px"}},k=Object(i["m"])("p",null,"Recomendación:",-1),E=Object(i["m"])("br",null,null,-1);Object(i["C"])();var q=a((function(e,t,n,a,q,N){var S,T,A=Object(i["J"])("nav-bar"),M=Object(i["J"])("modal");return Object(i["B"])(),Object(i["j"])(i["b"],null,[Object(i["m"])(A,{name:null===(S=e.userInfoJson)||void 0===S?void 0:S.nombres,lastName:null===(T=e.userInfoJson)||void 0===T?void 0:T.apellidos},null,8,["name","lastName"]),Object(i["m"])(M,{show:!!e.message,title:e.message,onClose:e.handleError,error:e.error,loading:e.loading},null,8,["show","title","onClose","error","loading"]),Object(i["m"])("section",r,[Object(i["m"])("h1",{style:{"text-align":"left",cursor:"pointer"},onClick:t[1]||(t[1]=function(){return e.back&&e.back.apply(e,arguments)})},[o,c]),u,e.canEdit?(Object(i["B"])(),Object(i["j"])("div",s,[Object(i["m"])("div",null,[d,Object(i["m"])("input",{class:"percentage",type:"number",min:e.porcentajeCumplimiento,onChange:t[2]||(t[2]=function(){return e.setValue&&e.setValue.apply(e,arguments)}),value:e.porcentajeCumplimientoDeseado},null,40,["min","value"]),Object(i["m"])("abbr",{title:"El valor debe ser mayor o igual a "+e.porcentajeCumplimiento},[l],8,["title"])]),Object(i["m"])("div",null,[Object(i["m"])("table",m,[p,Object(i["m"])("tbody",{class:e.rowBodyStyle?e.rowBodyStyle:""},[Object(i["m"])("tr",null,[Object(i["m"])("td",null,Object(i["L"])(e.nivelDeRiesgo),1),Object(i["m"])("td",null,Object(i["L"])(e.porcentajeCumplimiento)+" %",1)])],2)])]),Object(i["m"])("div",b,[Object(i["m"])("button",{class:"action-button",onClick:t[3]||(t[3]=function(){return e.summary&&e.summary.apply(e,arguments)})},"Resumen"),Object(i["m"])("button",{class:["action-button",e.porcentajeCumplimientoDeseado<e.porcentajeCumplimiento?"action-button blocked":"action-button"],onClick:t[4]||(t[4]=function(){return e.idealScenario&&e.idealScenario.apply(e,arguments)}),disabled:e.porcentajeCumplimientoDeseado<e.porcentajeCumplimiento}," Escenario deseado ",10,["disabled"])])])):Object(i["k"])("",!0),Object(i["m"])("div",v,[Object(i["m"])("div",f,[Object(i["m"])("h1",null,Object(i["L"])(e.headingTitle),1)]),Object(i["m"])("div",j,[(Object(i["B"])(!0),Object(i["j"])(i["b"],null,Object(i["H"])(e.requerimientos,(function(t,n){var a,r,o,c,u,s,d;return Object(i["B"])(),Object(i["j"])("div",{class:"body-item",key:t.requerimientoId},[Object(i["m"])("div",g,[Object(i["m"])("h3",null,"Pregunta "+Object(i["L"])(t.posicion?t.posicion:n+1)+":",1),Object(i["m"])("span",h,Object(i["L"])(t.descripcion),1),Object(i["m"])("span",O,Object(i["L"])(e.respuestaItem(n)),1)]),Object(i["m"])("div",x,[Object(i["m"])("div",I,[y,Object(i["m"])("textarea",{name:"justificacion",id:"justi",cols:"80",rows:"5",style:{width:"85%"},disabled:"true",value:null===(a=e.evidenciaRequerimiento[n])||void 0===a?void 0:a.justificacion},null,8,["value"]),Object(i["m"])("div",null,[R,Object(i["m"])("span",{style:{textdecoration:"underline",cursor:"pointer"},onClick:function(t){return e.downloadEvidencia(e.evidencia[n])}},"Descargar evidencia",8,["onClick"])])]),w,e.evidenciaRequerimiento[n]?(Object(i["B"])(),Object(i["j"])("div",C,[k,Object(i["U"])(Object(i["m"])("textarea",{name:"recomendacion",id:"recom",cols:"120",rows:"5",style:{width:"85%"},disabled:"true","onUpdate:modelValue":function(t){return e.evidenciaRequerimiento[n].recomendacion=t}},null,8,["onUpdate:modelValue"]),[[i["Q"],e.evidenciaRequerimiento[n].recomendacion]]),null!=(null===(r=e.evidenciaRequerimiento[n])||void 0===r?void 0:r.respuestaItem)&&1!=(null===(o=e.evidenciaRequerimiento[n])||void 0===o?void 0:o.respuestaItem)&&e.canEdit?(Object(i["B"])(),Object(i["j"])("button",{key:0,class:null==(null===(c=e.evidenciaRequerimiento[n])||void 0===c?void 0:c.respuestaItem)||1==(null===(u=e.evidenciaRequerimiento[n])||void 0===u?void 0:u.respuestaItem)||null!==(s=e.evidenciaRequerimiento[n])&&void 0!==s&&s.accionMigitagcion?"action-button thin blocked":"action-button thin",onClick:function(t){return e.saveRecomendacion(n)},disabled:null===(d=e.evidenciaRequerimiento[n])||void 0===d?void 0:d.accionMigitagcion}," Añadir ("+Object(i["L"])(e.accionesMitigacionCreadas)+") ",11,["onClick","disabled"])):Object(i["k"])("",!0)])):Object(i["k"])("",!0),E])])})),128))])])])],64)})),N=n("b85c"),S=n("1da1"),T=(n("96cf"),n("d3b7"),n("99af"),n("3ca3"),n("ddb0"),n("2b3d"),n("a9e3"),n("25f0"),n("4de4"),n("d81d"),n("7db0"),n("159b"),n("4e82"),n("4ec9"),n("5c40")),A=n("f464"),M=n("d43e"),_=n("f50d"),L=n("b74e"),B=n("2dd4"),D=n("705f"),J=n("2fc2"),U=Object(T["p"])({components:{NavBar:A["a"],Modal:D["a"]},data:function(){return{userInfoJson:Object(M["h"])(),headingTitle:"Resumen",evidencia:[],evidenciaRequerimiento:[],requerimientos:[],criterios:[],porcentajeCumplimiento:0,porcentajeCumplimientoDeseado:0,nivelDeRiesgo:"",accionesMitigacionCreadas:0,message:null,loading:!1,pruebaResultados:{},error:!1,canEdit:!1}},methods:{downloadEvidencia:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.message="Cargando...";try{fetch("".concat(J["c"],"evidencia/downloadfile/").concat(e.adjuntoURL),{method:"GET",headers:new Headers({Authorization:"Bearer "+localStorage.getItem("token")})}).then((function(e){return e.blob()})).then((function(n){var i=window.URL.createObjectURL(n),a=document.createElement("a");a.href=i,a.download=e.adjunto,document.body.appendChild(a),a.click(),a.remove(),t.message=null}))}catch(i){console.log(i)}case 2:case"end":return n.stop()}}),n)})))()},handleError:function(){this.message=null},setValue:function(e){Number(e.target.value)<this.porcentajeCumplimiento&&(e.target.value=this.porcentajeCumplimiento.toString()),this.porcentajeCumplimientoDeseado=+e.target.value},back:function(){this.$router.back()},summary:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.realScenario();case 2:case"end":return t.stop()}}),t)})))()},idealScenario:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,i,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.porcentajeCumplimientoDeseado<e.porcentajeCumplimiento)){t.next=2;break}return t.abrupt("return");case 2:return e.message="Cargando...",t.prev=3,t.next=6,fetch("".concat(J["c"],"prueba/").concat(e.$route.params.pr_codigo,"/").concat(e.porcentajeCumplimientoDeseado),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 6:return n=t.sent,t.next=9,Object(L["a"])(n);case 9:return t.next=11,n.json();case 11:i=t.sent,e.requerimientos=e.requerimientos.filter((function(e,t){return i.some((function(n){if(n.requerimientoId==e.requerimientoId)return e.posicion=t+1,!0}))})),i.length>0&&(e.evidencia=[],e.evidenciaRequerimiento=[],i=e.requerimientos.map((function(e){return i.find((function(t){return t.requerimientoId==e.requerimientoId}))})).filter((function(e){return void 0!==e})),i.forEach((function(t){var n,i,a,r,o;e.evidencia.push({evidenciaId:null===(n=t.evidencia)||void 0===n?void 0:n.evidenciaId,nombre:null===(i=t.evidencia)||void 0===i?void 0:i.nombre,adjunto:null===(a=t.evidencia)||void 0===a?void 0:a.adjunto,codigo:null===(r=t.evidencia)||void 0===r?void 0:r.codigo,adjuntoURL:null===(o=t.evidencia)||void 0===o?void 0:o.adjuntoURL}),e.evidenciaRequerimiento.push({evidenciaId:t.evidenciaId,requerimientoId:t.requerimientoId,pruebaId:t.pruebaId,justificacion:t.justificacion,respuestaItem:t.respuestaItem,recomendacion:t.recomendacion,tratamientoId:t.tratamientoId,tratamientoCodigo:t.tratamientoCodigo,accionMigitagcion:t.accionMigitagcion})}))),e.headingTitle="Escenario deseado",e.message="",t.next=24;break;case 18:t.prev=18,t.t0=t["catch"](3),e.error=!0,a=JSON.parse(t.t0.message),r=a.errores.mensaje,e.message=r;case 24:case"end":return t.stop()}}),t,null,[[3,18]])})))()},realScenario:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n,i,a,r,o,c,u,s,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.message="Cargando...",t.prev=1,t.next=4,fetch("".concat(J["c"],"listaverificaciones/lista?filter=").concat(e.$route.params.lv_codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 4:return n=t.sent,t.next=7,n.json();case 7:i=t.sent,a=i[0].requerimientos.map((function(e){return e.criterio})).sort((function(e,t){return e.descripcion.localeCompare(t.descripcion)})),r=new Map,o=Object(N["a"])(a);try{for(o.s();!(c=o.n()).done;)u=c.value,r.has(u.descripcion)||(r.set(u.descripcion,!0),e.criterios.push(u))}catch(l){o.e(l)}finally{o.f()}e.requerimientos=i[0].requerimientos.sort((function(e,t){return e.criterio.descripcion.localeCompare(t.criterio.descripcion)})),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](1),console.log(t.t0);case 18:return t.prev=18,t.next=21,fetch("".concat(J["c"],"evidenciarequerimiento/").concat(e.$route.params.pr_codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 21:return s=t.sent,t.next=24,s.json();case 24:d=t.sent,console.log(d),e.porcentajeCumplimiento=d[0].pruebaPorcentajeCumplimiento,e.accionesMitigacionCreadas=d.filter((function(e){return e.accionMigitagcion})).length,d.length>0&&(e.evidencia=[],e.evidenciaRequerimiento=[],d=e.requerimientos.map((function(e){return d.find((function(t){return t.requerimientoId==e.requerimientoId}))})).filter((function(e){return void 0!==e})),d.forEach((function(t){var n,i,a,r,o;e.evidencia.push({evidenciaId:null===(n=t.evidencia)||void 0===n?void 0:n.evidenciaId,nombre:null===(i=t.evidencia)||void 0===i?void 0:i.nombre,adjunto:null===(a=t.evidencia)||void 0===a?void 0:a.adjunto,codigo:null===(r=t.evidencia)||void 0===r?void 0:r.codigo,adjuntoURL:null===(o=t.evidencia)||void 0===o?void 0:o.adjuntoURL}),e.evidenciaRequerimiento.push({evidenciaId:t.evidenciaId,requerimientoId:t.requerimientoId,pruebaId:t.pruebaId,justificacion:t.justificacion,respuestaItem:t.respuestaItem,recomendacion:t.recomendacion,tratamientoId:t.tratamientoId,tratamientoCodigo:t.tratamientoCodigo,accionMigitagcion:t.accionMigitagcion})}))),e.headingTitle="Resumen",e.message="",t.next=36;break;case 33:t.prev=33,t.t1=t["catch"](18),console.log(t.t1);case 36:case"end":return t.stop()}}),t,null,[[1,15],[18,33]])})))()},obtenerPruebaResults:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(J["c"],"prueba/").concat(e.$route.params.pr_codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return n=t.sent,t.next=6,Object(L["a"])(n);case 6:return t.next=8,n.json();case 8:e.pruebaResultados=t.sent,e.nivelDeRiesgo=e.pruebaResultados.nivelDeRiesgo,t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](0),e.error=!0,JSON.parse(t.t0.message);case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))()},respuestaItem:function(e){var t,n="No implementado";switch(null===(t=this.evidenciaRequerimiento[e])||void 0===t?void 0:t.respuestaItem){case 1:n="Totalmente";break;case.5:n="Parcialmente";break;case 0:n="No implementado";break;case null:n="No aplica";break;default:break}return n},saveRecomendacion:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){var i,a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=t.evidenciaRequerimiento[e],a={TratamientoId:i.tratamientoId,AccionMitigacionId:Object(B["a"])(),Descripcion:t.requerimientos[e].descripcion,Estado:!1},n.prev=2,n.next=5,fetch("".concat(J["c"],"evidenciarequerimiento/").concat(i.pruebaId,"/").concat(i.requerimientoId),{method:"PUT",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}),body:JSON.stringify(a)});case 5:return r=n.sent,n.next=8,Object(L["a"])(r);case 8:t.evidenciaRequerimiento[e].accionMigitagcion=!0,t.accionesMitigacionCreadas++,n.next=15;break;case 12:n.prev=12,n.t0=n["catch"](2),console.log(n.t0);case 15:case"end":return n.stop()}}),n,null,[[2,12]])})))()}},mounted:function(){var e=this;Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(_["a"])();case 2:return e.userInfoJson=t.sent,e.userInfoJson.rol==J["p"].JEFE_DE_RIESGOS&&"true"==e.$route.query.edit?e.canEdit=!0:e.canEdit=!1,t.next=6,e.realScenario();case 6:return t.next=8,e.obtenerPruebaResults();case 8:case"end":return t.stop()}}),t)})))()}}),V=(n("b973"),n("d959")),G=n.n(V);const P=G()(U,[["render",q],["__scopeId","data-v-48489d1f"]]);t["default"]=P},"7db0":function(e,t,n){"use strict";var i=n("23e7"),a=n("b727").find,r=n("44d2"),o="find",c=!0;o in[]&&Array(1)[o]((function(){c=!1})),i({target:"Array",proto:!0,forced:c},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),r(o)},a0c2:function(e,t,n){"use strict";n("13ab")},a9e3:function(e,t,n){"use strict";var i=n("83ab"),a=n("da84"),r=n("94ca"),o=n("6eeb"),c=n("5135"),u=n("c6b6"),s=n("7156"),d=n("c04e"),l=n("d039"),m=n("7c73"),p=n("241c").f,b=n("06cf").f,v=n("9bf2").f,f=n("58a8").trim,j="Number",g=a[j],h=g.prototype,O=u(m(h))==j,x=function(e){var t,n,i,a,r,o,c,u,s=d(e,!1);if("string"==typeof s&&s.length>2)if(s=f(s),t=s.charCodeAt(0),43===t||45===t){if(n=s.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(s.charCodeAt(1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+s}for(r=s.slice(2),o=r.length,c=0;c<o;c++)if(u=r.charCodeAt(c),u<48||u>a)return NaN;return parseInt(r,i)}return+s};if(r(j,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var I,y=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof y&&(O?l((function(){h.valueOf.call(n)})):u(n)!=j)?s(new g(x(t)),n,y):x(t)},R=i?p(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),w=0;R.length>w;w++)c(g,I=R[w])&&!c(y,I)&&v(y,I,b(g,I));y.prototype=h,h.constructor=y,o(a,j,y)}},b973:function(e,t,n){"use strict";n("562b")},f464:function(e,t,n){"use strict";n("b0c0");var i=n("7a23"),a=n("cc25"),r=n.n(a),o=Object(i["W"])("data-v-dbc28712");Object(i["E"])("data-v-dbc28712");var c={class:"header"};Object(i["C"])();var u=o((function(e,t,n,a,o,u){return Object(i["B"])(),Object(i["j"])("div",c,[Object(i["m"])("img",{id:"logo",onClick:t[1]||(t[1]=function(t){return e.goToDashboard()}),alt:"logo_banner",src:r.a,width:"120",height:"50"}),Object(i["m"])("p",null,"Bienvenido: "+Object(i["L"])(e.name+" "+e.lastName),1)])})),s=n("5c40"),d=Object(s["p"])({props:["name","lastName"],methods:{goToDashboard:function(){this.$router.push("/dashboard")}}}),l=(n("a0c2"),n("d959")),m=n.n(l);const p=m()(d,[["render",u],["__scopeId","data-v-dbc28712"]]);t["a"]=p}}]);
//# sourceMappingURL=chunk-ee915058.ccf3db7a.js.map