(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5022e537"],{"208a":function(e,t,n){"use strict";n("d5c7")},"68d2":function(e,t,n){"use strict";n.r(t);n("b680");var a=n("7a23"),o=n("1d35"),c=n.n(o),i=n("c3e0"),r=n.n(i),s=n("6ae6"),u=n.n(s),d=n("ba97"),l=n.n(d),b=Object(a["J"])("data-v-89116d12");Object(a["s"])("data-v-89116d12");var m={key:0,id:"main"},g={class:"grid-container"},p={class:"grid-item"},h=Object(a["g"])("h4",null,"Código de tratamiento:",-1),j=Object(a["g"])("img",{src:c.a,alt:"codeva",class:"imgIcon"},null,-1),O={key:0},f={class:"grid-item"},v=Object(a["g"])("h4",null,"Código de evaluación:",-1),I=Object(a["g"])("img",{src:c.a,alt:"codeva",class:"imgIcon"},null,-1),k={key:0},w={style:{position:"absolute"}},E={key:2,class:"error"},x={class:"grid-item"},y=Object(a["g"])("h4",null,"Código de prueba:",-1),T=Object(a["g"])("img",{src:c.a,alt:"codeva",class:"imgIcon"},null,-1),C={class:"grid-item"},J=Object(a["g"])("h4",null,"Nombre del plan de tratamiento:",-1),A=Object(a["g"])("img",{src:r.a,alt:"codeva",class:"imgIcon"},null,-1),S={key:0},M={key:2,class:"error"},R={class:"grid-item"},_=Object(a["g"])("h4",null,"Estado:",-1),$=Object(a["g"])("img",{src:u.a,alt:"codeva",class:"imgIcon"},null,-1),z={key:0},L={key:0,class:"grid-item"},D=Object(a["g"])("h4",null,"Responsable:",-1),V=Object(a["g"])("img",{src:l.a,alt:"codeva",class:"imgIcon"},null,-1),F={key:0},H={class:"grid-item",style:{"margin-top":"50px"}},B={key:0,id:"acciones-mitigacion"},P=Object(a["g"])("h4",null,"Acciones de mitigación",-1),G=Object(a["g"])("br",null,null,-1),U={key:0,class:"flex-row table-options"},N=Object(a["f"])("   "),q={class:"grid"},K={class:"header-grid"},Q={key:0},W=Object(a["g"])("th",{style:{width:"60%"}},"Acciones de mitigación",-1),X=Object(a["g"])("th",{style:{width:"12.5%"}},"Fecha de inicio",-1),Y=Object(a["g"])("th",{style:{width:"12.5%"}},"Fecha de fin",-1),Z={key:1},ee={key:2},te=Object(a["g"])("th",{style:{width:"15%"}},"Estado",-1),ne={key:0},ae={style:{width:"60%","text-align":"left"}},oe={key:0,style:{width:"90%"}},ce={key:2,class:"far fa-envelope"},ie={style:{width:"12.5%"}},re={key:0},se={style:{width:"12.5%"}},ue={key:0},de=Object(a["g"])("i",{class:"fas fa-edit"},null,-1),le=Object(a["g"])("i",{class:"fas fa-trash-alt",style:{color:"red"}},null,-1),be={style:{width:"15%"}};Object(a["q"])();var me=b((function(e,t,n,o,c,i){var r,s,u,d,l=Object(a["x"])("nav-bar"),b=Object(a["x"])("confirmation-modal"),me=Object(a["x"])("modal");return Object(a["p"])(),Object(a["d"])(a["a"],null,[Object(a["g"])(l,{name:null===(r=e.userInfoJson)||void 0===r?void 0:r.nombres,lastName:null===(s=e.userInfoJson)||void 0===s?void 0:s.apellidos},null,8,["name","lastName"]),Object(a["g"])(b,{error:null,show:e.showModalConfirmation,title:e.modalTitle,massiveDelete:e.massiveDelete,onConfirm:e.deleteAccion,onConfirmMassive:e.confirmMassiveDelete,onCancel:e.closeModal},null,8,["show","title","massiveDelete","onConfirm","onConfirmMassive","onCancel"]),Object(a["g"])(me,{show:!(!e.loading||e.userValidated),title:e.message,onClose:t[1]||(t[1]=function(){}),error:e.error,loading:e.loading},null,8,["show","title","error","loading"]),Object(a["g"])(me,{show:!!e.message,title:e.message,onClose:e.handleError,error:e.error,loading:e.loading},null,8,["show","title","onClose","error","loading"]),e.userValidated?(Object(a["p"])(),Object(a["d"])("section",m,[Object(a["g"])("h1",null,Object(a["z"])(e.displayTitlePage),1),Object(a["g"])("button",{class:e.$route.params.tr_codigo?"action-button":"action-button blocked",onClick:t[2]||(t[2]=function(t){return e.register()})},Object(a["z"])(e.displayButtonText),3),Object(a["g"])("div",g,[Object(a["g"])("div",p,[h,j,e.$route.params.tr_codigo&&!e.canEdit||e.$route.params.tr_codigo&&e.canEdit&&!e.update?(Object(a["p"])(),Object(a["d"])("span",O,Object(a["z"])(e.tratamientoInfoJson.codigo),1)):Object(a["e"])("",!0),!e.update&&e.$route.params.tr_codigo||!e.canEdit?Object(a["e"])("",!0):(Object(a["p"])(),Object(a["d"])("input",{key:1,type:"text",disabled:"true",placeholder:e.tratamientoInfoJson.codigo},null,8,["placeholder"]))]),Object(a["g"])("div",f,[v,I,e.$route.params.tr_codigo&&!e.canEdit||e.$route.params.tr_codigo&&e.canEdit&&!e.update?(Object(a["p"])(),Object(a["d"])("span",k,Object(a["z"])(e.codigoEvaluacion),1)):Object(a["e"])("",!0),!e.update&&e.$route.params.tr_codigo||!e.canEdit?Object(a["e"])("",!0):Object(a["H"])((Object(a["p"])(),Object(a["d"])("input",{key:1,type:"text",placeholder:"Buscar por código",onKeyup:t[3]||(t[3]=function(){return e.searchCodigoEvaluacion&&e.searchCodigoEvaluacion.apply(e,arguments)}),"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.codigoEvaluacion=t})},null,544)),[[a["E"],e.codigoEvaluacion,void 0,{trim:!0}]]),Object(a["g"])("div",w,[(Object(a["p"])(!0),Object(a["d"])(a["a"],null,Object(a["v"])(e.evaluacionList,(function(t){return Object(a["p"])(),Object(a["d"])("p",{class:"dropdownSelect",key:t.evaluacionId,onClick:function(n){return e.selectEvaluacion(t)}},Object(a["z"])(t.codigo+"-"+t.nombre),9,["onClick"])})),128))]),e.validationForm.evaluacionId?(Object(a["p"])(),Object(a["d"])("p",E,Object(a["z"])(e.validationForm.evaluacionId),1)):Object(a["e"])("",!0)]),Object(a["g"])("div",x,[y,T,Object(a["H"])(Object(a["g"])("select",{class:"select","onUpdate:modelValue":t[5]||(t[5]=function(t){return e.codigoPrueba=t}),name:"prueba"},[(Object(a["p"])(!0),Object(a["d"])(a["a"],null,Object(a["v"])(e.pruebas,(function(e){return Object(a["p"])(),Object(a["d"])("option",{key:e.pruebaId,value:e.codigo},Object(a["z"])(e.codigo),9,["value"])})),128))],512),[[a["D"],e.codigoPrueba]])]),Object(a["g"])("div",C,[J,A,e.$route.params.tr_codigo&&!e.canEdit||e.$route.params.tr_codigo&&e.canEdit&&!e.update?(Object(a["p"])(),Object(a["d"])("span",S,Object(a["z"])(e.tratamientoInfoJson.nombre),1)):Object(a["e"])("",!0),!e.update&&e.$route.params.tr_codigo||!e.canEdit?Object(a["e"])("",!0):Object(a["H"])((Object(a["p"])(),Object(a["d"])("input",{key:1,type:"text",placeholder:"Plan de tratamiento-nombre","onUpdate:modelValue":t[6]||(t[6]=function(t){return e.tratamientoInfoJson.nombre=t})},null,512)),[[a["E"],e.tratamientoInfoJson.nombre,void 0,{trim:!0}]]),e.validationForm.nombre?(Object(a["p"])(),Object(a["d"])("p",M,Object(a["z"])(e.validationForm.nombre),1)):Object(a["e"])("",!0)]),Object(a["g"])("div",R,[_,$,e.$route.params.tr_codigo&&!e.update?(Object(a["p"])(),Object(a["d"])("span",z,Object(a["z"])(e.estadoCalc()),1)):Object(a["e"])("",!0),e.update||!e.$route.params.tr_codigo?Object(a["H"])((Object(a["p"])(),Object(a["d"])("select",{key:1,class:"select","onUpdate:modelValue":t[7]||(t[7]=function(t){return e.tratamientoInfoJson.estadosTratamientoId=t}),onChange:t[8]||(t[8]=function(){return e.changedEstado&&e.changedEstado.apply(e,arguments)}),name:"estado"},[(Object(a["p"])(!0),Object(a["d"])(a["a"],null,Object(a["v"])(e.estadoList,(function(e){return Object(a["p"])(),Object(a["d"])("option",{key:e.estadosTratamientoId,value:e.estadosTratamientoId},Object(a["z"])(e.nombre),9,["value"])})),128))],544)),[[a["D"],e.tratamientoInfoJson.estadosTratamientoId]]):Object(a["e"])("",!0)]),e.asignadoSeleccionado?(Object(a["p"])(),Object(a["d"])("div",L,[D,V,e.$route.params.tr_codigo&&!e.canEdit||e.$route.params.tr_codigo&&e.canEdit&&!e.update?(Object(a["p"])(),Object(a["d"])("span",F,Object(a["z"])(e.analistaCalc()),1)):Object(a["e"])("",!0),!e.update&&e.$route.params.tr_codigo||!e.canEdit?Object(a["e"])("",!0):Object(a["H"])((Object(a["p"])(),Object(a["d"])("select",{key:1,class:"select","onUpdate:modelValue":t[9]||(t[9]=function(t){return e.tratamientoInfoJson.usuarioId=t}),name:"analista"},[(Object(a["p"])(!0),Object(a["d"])(a["a"],null,Object(a["v"])(e.analistaList,(function(e){return Object(a["p"])(),Object(a["d"])("option",{key:e.usuarioId,value:e.usuarioId},Object(a["z"])(e.codigo+"-"+e.nombres+" "+e.apellidos),9,["value"])})),128))],512)),[[a["D"],e.tratamientoInfoJson.usuarioId]])])):Object(a["e"])("",!0),Object(a["g"])("div",H,[Object(a["g"])("h4",null,[Object(a["g"])("strong",null,"Porcentaje de avance: "+Object(a["z"])(null===(u=e.tratamientoInfoJson)||void 0===u||null===(d=u.porcentajeAvance)||void 0===d?void 0:d.toFixed(2))+" %",1)])])]),e.showAccionesMitigacion?(Object(a["p"])(),Object(a["d"])("section",B,[P,G,e.update&&e.canEdit?(Object(a["p"])(),Object(a["d"])("div",U,[Object(a["g"])("div",null,[Object(a["g"])("i",{class:"fas fa-plus-circle",onClick:t[10]||(t[10]=function(){return e.goToTestSummary&&e.goToTestSummary.apply(e,arguments)})}),N,Object(a["g"])("span",{style:{"text-decoration":"underline",cursor:"pointer"},onClick:t[11]||(t[11]=function(){return e.goToTestSummary&&e.goToTestSummary.apply(e,arguments)})},"Añadir nueva acción")]),Object(a["g"])("div",null,[Object(a["g"])("button",{class:"action-button table",onClick:t[12]||(t[12]=function(t){return e.deleteMassive()})}," Eliminación massiva ")])])):Object(a["e"])("",!0),Object(a["g"])("table",q,[Object(a["g"])("thead",K,[Object(a["g"])("tr",null,[e.update&&e.accionesMitigacion.length>0&&e.canEdit?(Object(a["p"])(),Object(a["d"])("th",Q,[Object(a["H"])(Object(a["g"])("input",{type:"checkbox",id:"checkbox","onUpdate:modelValue":t[13]||(t[13]=function(t){return e.massiveCheck=t})},null,512),[[a["B"],e.massiveCheck]])])):Object(a["e"])("",!0),W,X,Y,e.update?(Object(a["p"])(),Object(a["d"])("th",Z)):Object(a["e"])("",!0),e.update&&e.canEdit?(Object(a["p"])(),Object(a["d"])("th",ee)):Object(a["e"])("",!0),te])]),Object(a["g"])("tbody",null,[(Object(a["p"])(!0),Object(a["d"])(a["a"],null,Object(a["v"])(e.accionesMitigacion,(function(n){return Object(a["p"])(),Object(a["d"])("tr",{key:n.accionMitigacionId},[e.update&&e.canEdit?(Object(a["p"])(),Object(a["d"])("td",ne,[Object(a["H"])(Object(a["g"])("input",{type:"checkbox",id:n.accionMitigacionId,value:n.accionMitigacionId,"onUpdate:modelValue":t[14]||(t[14]=function(t){return e.checkedEntities=t})},null,8,["id","value"]),[[a["B"],e.checkedEntities]])])):Object(a["e"])("",!0),Object(a["g"])("td",ae,[Object(a["g"])("div",null,[e.$route.params.tr_codigo&&!e.canEdit||e.canEdit&&!e.update?(Object(a["p"])(),Object(a["d"])("span",oe,Object(a["z"])(n.descripcion),1)):Object(a["e"])("",!0),e.update&&e.canEdit?Object(a["H"])((Object(a["p"])(),Object(a["d"])("input",{key:1,type:"text",style:{width:"90%","margin-left":"5px"},"onUpdate:modelValue":function(e){return n.descripcion=e}},null,8,["onUpdate:modelValue"])),[[a["E"],n.descripcion]]):Object(a["e"])("",!0),n.tieneMensaje?(Object(a["p"])(),Object(a["d"])("i",ce)):Object(a["e"])("",!0)])]),Object(a["g"])("td",ie,[e.$route.params.tr_codigo&&!e.update?(Object(a["p"])(),Object(a["d"])("span",re,Object(a["z"])(n.fechaInicio?new Date(n.fechaInicio).toISOString().substr(0,10):(new Date).toISOString().substr(0,10)),1)):Object(a["e"])("",!0),e.update?(Object(a["p"])(),Object(a["d"])("input",{key:1,type:"date",onChange:function(e){return n.fechaInicio=e.target.value},value:e.userInfoJson&&n.fechaInicio?new Date(n.fechaInicio).toISOString().substr(0,10):null},null,40,["onChange","value"])):Object(a["e"])("",!0)]),Object(a["g"])("td",se,[e.$route.params.tr_codigo&&!e.update?(Object(a["p"])(),Object(a["d"])("span",ue,Object(a["z"])(n.fechaFin?new Date(n.fechaFin).toISOString().substr(0,10):(new Date).toISOString().substr(0,10)),1)):Object(a["e"])("",!0),e.update?(Object(a["p"])(),Object(a["d"])("input",{key:1,type:"date",onChange:function(e){return n.fechaFin=e.target.value},value:e.userInfoJson&&n.fechaFin?new Date(n.fechaFin).toISOString().substr(0,10):null},null,40,["onChange","value"])):Object(a["e"])("",!0)]),e.update?(Object(a["p"])(),Object(a["d"])("td",{key:1,onClick:function(t){return e.editAccion(n)}},[de],8,["onClick"])):Object(a["e"])("",!0),e.update&&e.canEdit?(Object(a["p"])(),Object(a["d"])("td",{key:2,onClick:function(t){return e.deleteConfirm(n)}},[le],8,["onClick"])):Object(a["e"])("",!0),Object(a["g"])("td",be,[Object(a["g"])("p",{class:n.estado?"label success":"label error"},Object(a["z"])(n.estado?"Terminado":"En Proceso"),3)])])})),128))])])])):Object(a["e"])("",!0)])):Object(a["e"])("",!0)],64)})),ge=n("5530"),pe=n("1da1"),he=(n("d81d"),n("7db0"),n("d3b7"),n("99af"),n("ac1f"),n("5319"),n("4de4"),n("b64b"),n("3ca3"),n("ddb0"),n("96cf"),n("f464")),je=n("b7ff"),Oe=n("f50d"),fe=n("d43e"),ve=n("5c40"),Ie=n("2fc2"),ke=n("b74e"),we=n("705f"),Ee=Object(ve["l"])({components:{NavBar:he["a"],ConfirmationModal:je["a"],Modal:we["a"]},computed:{evaluacion:function(){return this.$store.getters["evaluacionModule/obtenerEvaluacion"]},displayButtonText:function(){return this.$route.params.tr_codigo?this.update?"Guardar":"Editar":"Registrar"},displayTitlePage:function(){return this.$route.params.tr_codigo?this.update?"Editar plan de tratamiento":"Visualizar plan de tratamiento":"Registrar plan de tratamiento"}},data:function(){return{userInfoJson:Object(fe["h"])(),codigoEvaluacion:"",codigoPrueba:"",codigoListaVerificacion:"",timeout:void 0,evaluacionList:[],analistaList:[],estadoList:[],pruebas:[],showAccionesMitigacion:!1,validationForm:{},tratamientoInfoJson:Object(fe["g"])(),massiveCheck:!1,checkedEntities:[],accionesMitigacion:[],accionSelected:"",esAltaGerencia:!1,message:null,loading:!1,error:!1,update:!1,modalTitle:"",showModalConfirmation:!1,massiveDelete:!1,canEdit:!1,asignadoSeleccionado:!1,hasTouchedEstado:!1,userValidated:!1}},watch:{codigoPrueba:function(){var e=this;return Object(pe["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$route.params.tr_codigo){t.next=3;break}return t.next=3,e.fetchAccionesMitigacion();case 3:case"end":return t.stop()}}),t)})))()},massiveCheck:function(){this.massiveCheck?this.checkedEntities=this.accionesMitigacion.map((function(e){return e.accionMitigacionId})):this.checkedEntities=[]}},methods:{changedEstado:function(e){var t=this;return Object(pe["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.hasTouchedEstado=!0,a=t.estadoList.find((function(t){return t.estadosTratamientoId==e.target.value})),!a||"Asignado"!=a.nombre&&"En proceso"!=a.nombre?t.asignadoSeleccionado=!1:t.asignadoSeleccionado=!0;case 3:case"end":return n.stop()}}),n)})))()},estadoCalc:function(){var e=this,t=this.estadoList.find((function(t){return t.estadosTratamientoId==e.tratamientoInfoJson.estadosTratamientoId}));return t?("Asignado"!=t.nombre&&"En proceso"!=t.nombre||(this.asignadoSeleccionado=!0),t.nombre):""},analistaCalc:function(){var e=this,t=this.analistaList.find((function(t){return t.usuarioId==e.tratamientoInfoJson.usuarioId}));return t?t.codigo+"-"+t.nombres+" "+t.apellidos:""},handleError:function(){this.message=null},closeModal:function(){this.showModalConfirmation=!1},searchCodigoEvaluacion:function(){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout(Object(pe["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchEvaluacion();case 2:case"end":return t.stop()}}),t)}))),1e3)},fetchEvaluacion:function(){var e=this;return Object(pe["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(Ie["c"],"evaluacion/lista?filter=").concat(e.codigoEvaluacion),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return n=t.sent,t.next=6,n.json();case 6:e.evaluacionList=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},fetchAnalista:function(){var e=this;return Object(pe["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(Ie["c"],"usuario/lista/Analistas"),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return n=t.sent,t.next=6,n.json();case 6:e.analistaList=t.sent,null==e.tratamientoInfoJson.usuarioId&&(e.tratamientoInfoJson.usuarioId=e.analistaList[0].usuarioId),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},selectEvaluacion:function(e){this.tratamientoInfoJson.evaluacionId=e.evaluacionId,this.evaluacionList=[],this.codigoEvaluacion=e.codigo+"-"+e.nombre,this.pruebas=e.pruebaList},deleteConfirm:function(e){this.accionSelected=e.accionMitigacionId,this.modalTitle="Está seguro que desea eliminar la acción de mitigación?",this.showModalConfirmation=!0},deleteMassive:function(){this.checkedEntities.length>0?(this.massiveDelete=!0,this.showModalConfirmation=!0,this.modalTitle="Está seguro que desea eliminar las acciones de mitigación seleccionadas ?"):(this.message="Debe seleccionar al menos una acción de mitigación",this.error=!0)},register:function(){var e=this;return Object(pe["a"])(regeneratorRuntime.mark((function t(){var n,a,o,c,i,r,s,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$route.params.tr_codigo||e.update){t.next=3;break}return e.update=!0,t.abrupt("return");case 3:if(e.validationForm={},n=["evaluacionId","nombre"],a=Object(ke["b"])(n,e.tratamientoInfoJson),o=Object(ke["d"])(a,e.validationForm),c=e.estadoList.find((function(t){return t.estadosTratamientoId==e.tratamientoInfoJson.estadosTratamientoId})),"Jefe de riesgos"!=e.userInfoJson.rol||"En proceso"!=(null===c||void 0===c?void 0:c.nombre)||!e.hasTouchedEstado){t.next=12;break}return e.error=!0,e.message="Este estado solo puede ser seleccionado por un analista",t.abrupt("return");case 12:if(!o){t.next=53;break}if(e.$route.params.tr_codigo){t.next=36;break}return t.prev=14,t.next=17,fetch("".concat(Ie["c"],"plantratamiento"),{method:"POST",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}),body:JSON.stringify(e.tratamientoInfoJson)});case 17:return i=t.sent,t.next=20,Object(ke["a"])(i);case 20:return t.next=22,i.json();case 22:r=t.sent,e.$router.replace("/plan-tratamiento/".concat(r.codigo)),e.showAccionesMitigacion=!0,e.loading=!1,e.error=!1,e.message="¡El plan de tratamiento ha sido registrado exitósamente!",setTimeout(Object(pe["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.message="",t.next=3,e.fetchTratamiento();case 3:case"end":return t.stop()}}),t)}))),1500),t.next=34;break;case 31:t.prev=31,t.t0=t["catch"](14),console.log(t.t0);case 34:t.next=53;break;case 36:return s=Object(ge["a"])(Object(ge["a"])({},e.tratamientoInfoJson),{},{AccionMitigacionList:e.accionesMitigacion}),t.prev=37,t.next=40,fetch("".concat(Ie["c"],"plantratamiento/").concat(e.$route.params.tr_codigo),{method:"PUT",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}),body:JSON.stringify(s)});case 40:return u=t.sent,t.next=43,Object(ke["a"])(u);case 43:e.loading=!1,e.error=!1,e.message="¡El plan de tratamiento ha sido actualizado exitósamente!",location.reload(),setTimeout(Object(pe["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.message="";case 1:case"end":return t.stop()}}),t)}))),1500),t.next=53;break;case 50:t.prev=50,t.t1=t["catch"](37),console.log(t.t1);case 53:case"end":return t.stop()}}),t,null,[[14,31],[37,50]])})))()},goToTestSummary:function(){this.$router.push("/lista-verificacion/".concat(this.codigoListaVerificacion,"/prueba/").concat(this.codigoPrueba,"/resumen"))},fetchTratamientoEstados:function(){var e=this;return Object(pe["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(Ie["c"],"estadotratamiento/lista?rolUsuario=").concat(e.userInfoJson.rol),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return n=t.sent,t.next=6,n.json();case 6:e.estadoList=t.sent,e.$route.params.tr_codigo||(e.estadoList=e.estadoList.filter((function(e){return"Sin asignar"==e.nombre||"Asignado"==e.nombre}))),(null==e.tratamientoInfoJson.estadosTratamientoId||void 0==e.tratamientoInfoJson.estadosTratamientoId)&&(e.tratamientoInfoJson.estadosTratamientoId=e.estadoList[0].estadosTratamientoId),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},fetchTratamiento:function(){var e=this;return Object(pe["a"])(regeneratorRuntime.mark((function t(){var n,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(Ie["c"],"plantratamiento/").concat(e.$route.params.tr_codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return n=t.sent,t.next=6,n.json();case 6:a=t.sent,o=Object.keys(e.tratamientoInfoJson),e.tratamientoInfoJson=Object(ke["b"])(o,a),e.userInfoJson.rol==Ie["o"].ANALISTA&&e.tratamientoInfoJson.usuarioId!==e.userInfoJson.id&&(e.loading=!1,e.$router.replace("/dashboard")),e.codigoEvaluacion=a.codigoEvaluacion,e.pruebas=a.pruebas.filter((function(e){return e.visibilidad})),e.codigoPrueba=e.pruebas[0].codigo,e.codigoListaVerificacion=a.listaVerificacionCodigo,t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](0),console.log(t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})))()},fetchAccionesMitigacion:function(){var e=this;return Object(pe["a"])(regeneratorRuntime.mark((function t(){var n,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(Ie["c"],"accionmitigacion/").concat(e.tratamientoInfoJson.tratamientoId,"/").concat(e.codigoPrueba),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return n=t.sent,t.next=6,n.json();case 6:e.accionesMitigacion=t.sent,e.accionesMitigacion.length>0?(a=e.accionesMitigacion.length,o=e.accionesMitigacion.filter((function(e){return 1==e.estado})).length,e.tratamientoInfoJson.porcentajeAvance=o/a*100):e.tratamientoInfoJson.porcentajeAvance=0,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},editAccion:function(e){var t=this;return Object(pe["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.$router.push("/accion-mitigacion/edicion/".concat(e.accionMitigacionId));case 1:case"end":return n.stop()}}),n)})))()},deleteAccion:function(e){var t=this;return Object(pe["a"])(regeneratorRuntime.mark((function n(){var a,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.closeModal(),console.log("SelectedAccion",t.accionSelected),console.log("eachAction",e),a=e||t.accionSelected,n.prev=4,n.next=7,fetch("".concat(Ie["c"],"accionmitigacion/").concat(a),{method:"DELETE",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 7:return o=n.sent,n.next=10,Object(ke["a"])(o);case 10:e||(t.message="¡Se ha eliminado accion exitósamente!",setTimeout(Object(pe["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.message="",e.next=3,t.fetchAccionesMitigacion();case 3:case"end":return e.stop()}}),e)}))),1e3)),n.next=16;break;case 13:n.prev=13,n.t0=n["catch"](4),console.log(n.t0);case 16:case"end":return n.stop()}}),n,null,[[4,13]])})))()},confirmMassiveDelete:function(){var e=this;return Object(pe["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.checkedEntities.map(function(){var t=Object(pe["a"])(regeneratorRuntime.mark((function t(n){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.deleteAccion(n);case 3:a=t.sent,console.log(a),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()));case 2:e.massiveDelete=!1,e.showModalConfirmation=!1,e.modalTitle="",e.message="¡Se ha eliminado las acciones de mitigacion exitósamente!",setTimeout(Object(pe["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchAccionesMitigacion();case 2:e.message=null;case 3:case"end":return t.stop()}}),t)}))),1e3);case 7:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;this.loading=!0,Object(pe["a"])(regeneratorRuntime.mark((function t(){var n,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(Oe["a"])();case 2:return e.userInfoJson=t.sent,e.userInfoJson.rol!==Ie["o"].JEFE_DE_RIESGOS&&e.userInfoJson.rol!==Ie["o"].ANALISTA&&e.userInfoJson.rol!==Ie["o"].ALTA_GERENCIA&&(e.loading=!1,e.$router.replace("/dashboard")),e.userInfoJson.rol==Ie["o"].JEFE_DE_RIESGOS?e.canEdit=!0:e.canEdit=!1,e.userInfoJson.rol==Ie["o"].ALTA_GERENCIA&&(e.esAltaGerencia=!0),t.next=8,e.fetchAnalista();case 8:if(e.$route.params.tr_codigo){t.next=25;break}return t.prev=9,t.next=12,fetch("".concat(Ie["c"],"plantratamiento/ultimoCodigo"),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 12:return n=t.sent,t.next=15,n.json();case 15:a=t.sent,o=a.codigo,e.tratamientoInfoJson.codigo=o,t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](9),console.log(t.t0);case 23:t.next=30;break;case 25:return e.showAccionesMitigacion=!0,t.next=28,e.fetchTratamiento();case 28:return t.next=30,e.fetchAccionesMitigacion();case 30:return t.next=32,e.fetchTratamientoEstados();case 32:e.loading=!1,e.userValidated=!0;case 34:case"end":return t.stop()}}),t,null,[[9,20]])})))()}});n("208a");Ee.render=me,Ee.__scopeId="data-v-89116d12";t["default"]=Ee},d5c7:function(e,t,n){}}]);
//# sourceMappingURL=chunk-5022e537.c7a27a6e.js.map