(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4df60e2a"],{"3ce8":function(e,t,a){"use strict";a.r(t);var n=a("7a23"),c=a("1d35"),o=a.n(c),i=a("c3e0"),r=a.n(i),s=a("5f1f"),l=a.n(s),u=a("be24"),d=a.n(u),b=a("722d"),f=a.n(b),p=a("5b89"),g=a.n(p),O=a("2f97"),h=a.n(O),j=Object(n["J"])("data-v-7974a40d");Object(n["s"])("data-v-7974a40d");var v={id:"main"},m={class:"flex-row"},y={class:"flex-col"},k={class:""},w=Object(n["g"])("h3",null,"Código de evaluación",-1),I=Object(n["g"])("img",{src:o.a,alt:"codeva",class:"imgIcon"},null,-1),E={key:0,class:"non-editable"},x={key:1},C={key:0},R=Object(n["g"])("br",null,null,-1),S=Object(n["g"])("br",null,null,-1),L=Object(n["g"])("h3",null,"Seleccione lista de verificación",-1),V=Object(n["g"])("img",{src:r.a,alt:"listave",class:"imgIcon"},null,-1),z={key:0},A=Object(n["g"])("br",null,null,-1),T=Object(n["g"])("span",{style:{"font-weight":"bold"}},"Fecha de creación: ",-1),M=Object(n["g"])("br",null,null,-1),D=Object(n["g"])("span",{style:{"font-weight":"bold"}},"Requerimientos: ",-1),N=Object(n["g"])("br",null,null,-1),B=Object(n["g"])("br",null,null,-1),P=Object(n["g"])("br",null,null,-1),$=Object(n["g"])("h3",null,"Código de obra",-1),J=Object(n["g"])("img",{src:o.a,alt:"codobra",class:"imgIcon"},null,-1),H={key:1},q=Object(n["g"])("br",null,null,-1),U=Object(n["g"])("br",null,null,-1),F=Object(n["g"])("h3",null,"Nombre",-1),G=Object(n["g"])("img",{src:l.a,alt:"nombre",class:"imgIcon"},null,-1),_={key:1},K=Object(n["g"])("br",null,null,-1),Q=Object(n["g"])("br",null,null,-1),Y=Object(n["g"])("h3",null,"Fecha de creación",-1),X=Object(n["g"])("img",{src:d.a,alt:"fecha",class:"imgIcon"},null,-1),W={key:0,class:"non-editable"},Z={key:1},ee={class:"flex-col"},te={key:0},ae=Object(n["g"])("h3",null,"Estado",-1),ne=Object(n["g"])("img",{src:f.a,alt:"estado",class:"imgIcon"},null,-1),ce={key:0},oe={class:"non-editable transformacion"},ie={key:1},re=Object(n["g"])("br",null,null,-1),se=Object(n["g"])("br",null,null,-1),le={key:1},ue=Object(n["g"])("h3",null,"Estado",-1),de=Object(n["g"])("img",{src:f.a,alt:"estado",class:"imgIcon"},null,-1),be=Object(n["g"])("br",null,null,-1),fe=Object(n["g"])("br",null,null,-1),pe={key:0},ge=Object(n["g"])("img",{src:g.a,alt:"prueba",class:"imgIcon"},null,-1),Oe={key:2},he={id:"comentarios"},je=Object(n["g"])("br",null,null,-1),ve=Object(n["g"])("h3",null,"Observaciones",-1),me={key:0},ye=Object(n["g"])("br",null,null,-1),ke={style:{display:"flex",gap:"1vw"}},we=Object(n["g"])("br",null,null,-1),Ie={key:1},Ee={class:"card",style:{display:"flex",gap:"1vw"}},xe={key:0,style:{color:"#7aadff"}},Ce={key:2},Re=Object(n["g"])("h4",null,"No hay observaciones",-1),Se=Object(n["g"])("div",null,[Object(n["g"])("img",{src:h.a,alt:"obra"})],-1);Object(n["q"])();var Le=j((function(e,t,c,o,i,r){var s,l,u,d=Object(n["x"])("nav-bar"),b=Object(n["x"])("confirmation-modal"),f=Object(n["x"])("modal"),p=Object(n["x"])("grid");return Object(n["p"])(),Object(n["d"])(n["a"],null,[Object(n["g"])(d,{name:null===(s=e.userInfoJson)||void 0===s?void 0:s.nombres,lastName:null===(l=e.userInfoJson)||void 0===l?void 0:l.apellidos},null,8,["name","lastName"]),Object(n["g"])(b,{error:null,show:e.showModalConfirmation,title:e.modalTitle,massiveDelete:e.massiveDelete,onConfirm:e.confirmDelete,onConfirmMassive:e.confirmMassiveDelete,onCancel:e.closeModal},null,8,["show","title","massiveDelete","onConfirm","onConfirmMassive","onCancel"]),Object(n["g"])(f,{show:!!e.message,title:e.message,onClose:e.handleError,error:e.error,loading:e.loading},null,8,["show","title","onClose","error","loading"]),Object(n["g"])("section",v,[Object(n["g"])("h1",null,Object(n["z"])("registrar"==e.action?"Registrar evaluación de obra":"editar"==e.action?"Editar evaluación":"Visualizar evaluación"),1),e.esAltaGerencia||e.isJefeRiesgos?Object(n["e"])("",!0):(Object(n["p"])(),Object(n["d"])("button",{key:0,class:e.$route.params.id?"action-button":"action-button blocked",disabled:!e.$route.params.id&&!e.verifyPruebaCompleta,onClick:t[1]||(t[1]=function(){return e.submit&&e.submit.apply(e,arguments)})},Object(n["z"])(e.displayButtonAction),11,["disabled"])),e.isJefeRiesgos&&1==e.evaluacion.visibilidad&&"Aprobado"==e.evaluacion.estado?(Object(n["p"])(),Object(n["d"])("button",{key:1,class:e.$route.params.id?"action-button":"action-button blocked",onClick:t[2]||(t[2]=function(){return e.downloadPDF&&e.downloadPDF.apply(e,arguments)})}," Generar Informe ",2)):Object(n["e"])("",!0),Object(n["g"])("div",m,[Object(n["g"])("div",y,[Object(n["g"])("div",k,[w,I,"visualizar"!=e.action?(Object(n["p"])(),Object(n["d"])("div",E,Object(n["z"])(e.evaluacion.codigo),1)):Object(n["e"])("",!0),"visualizar"==e.action?(Object(n["p"])(),Object(n["d"])("span",x,Object(n["z"])(e.evaluacion.codigo),1)):Object(n["e"])("",!0)]),"registrar"==e.action?(Object(n["p"])(),Object(n["d"])("div",C,[R,S,L,V,Object(n["H"])(Object(n["g"])("input",{type:"text",placeholder:"Ingrese lista de verificación",disabled:""!=e.$route.params.id&&void 0!=e.$route.params.id,onKeyup:t[3]||(t[3]=function(){return e.searchListaVerificacion&&e.searchListaVerificacion.apply(e,arguments)}),"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.codigoListaVerificacion=t})},null,40,["disabled"]),[[n["E"],e.codigoListaVerificacion,void 0,{trim:!0}]]),(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["v"])(e.listasVerificacion,(function(t){return Object(n["p"])(),Object(n["d"])("p",{class:"dropdownSelect tamaño",key:t.listaVerificacionId,onClick:function(a){return e.selectListaVerificacion(t)}},Object(n["z"])(t.codigo+"-"+t.nombre),9,["onClick"])})),128)),e.selectedListaVerificacion.fechaCreacion?(Object(n["p"])(),Object(n["d"])("div",z,[A,T,Object(n["g"])("span",null,Object(n["z"])(null===(u=new Date(e.selectedListaVerificacion.fechaCreacion))||void 0===u?void 0:u.toLocaleDateString()),1),M,Object(n["g"])("p",null,[D,Object(n["f"])(Object(n["z"])(e.selectedListaVerificacion.requerimientosCount),1)]),N])):Object(n["e"])("",!0)])):Object(n["e"])("",!0),Object(n["g"])("div",null,[B,P,$,J,"visualizar"!=e.action?Object(n["H"])((Object(n["p"])(),Object(n["d"])("input",{key:0,type:"text",placeholder:"Ingrese código o nombre de obra",disabled:""!=e.$route.params.id&&void 0!=e.$route.params.id,onKeyup:t[5]||(t[5]=function(){return e.searchObra&&e.searchObra.apply(e,arguments)}),"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.codigoObra=t})},null,40,["disabled"])),[[n["E"],e.codigoObra,void 0,{trim:!0}]]):Object(n["e"])("",!0),(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["v"])(e.obras,(function(t){return Object(n["p"])(),Object(n["d"])("p",{class:"dropdownSelectobras tamaño",key:t.obraId,onClick:function(a){return e.SelectObra(t)}},Object(n["z"])(t.codigo+"-"+t.nombre),9,["onClick"])})),128)),"visualizar"==e.action?(Object(n["p"])(),Object(n["d"])("span",H,Object(n["z"])(e.codigoObra),1)):Object(n["e"])("",!0)]),Object(n["g"])("div",null,[q,U,F,G,"visualizar"!=e.action?Object(n["H"])((Object(n["p"])(),Object(n["d"])("input",{key:0,type:"text",placeholder:e.evaluacion.nombre,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.evaluacion.nombre=t})},null,8,["placeholder"])),[[n["E"],e.evaluacion.nombre,void 0,{trim:!0}]]):Object(n["e"])("",!0),"visualizar"==e.action?(Object(n["p"])(),Object(n["d"])("span",_,Object(n["z"])(e.evaluacion.nombre),1)):Object(n["e"])("",!0)]),Object(n["g"])("div",null,[K,Q,Y,X,"visualizar"!=e.action?(Object(n["p"])(),Object(n["d"])("div",W,Object(n["z"])(e.evaluacion.fechaCreacion),1)):Object(n["e"])("",!0),"visualizar"==e.action?(Object(n["p"])(),Object(n["d"])("span",Z,Object(n["z"])(e.evaluacion.fechaCreacion),1)):Object(n["e"])("",!0)])]),Object(n["g"])("div",ee,["visualizar"!=e.action?(Object(n["p"])(),Object(n["d"])("div",te,[ae,ne,"editar"!=e.action||e.isAnalista?(Object(n["p"])(),Object(n["d"])("div",ce,[Object(n["g"])("div",oe,Object(n["z"])(e.evaluacion.estado?e.evaluacion.estado:"Pendiente"),1)])):(Object(n["p"])(),Object(n["d"])("div",ie,[Object(n["H"])(Object(n["g"])("select",{class:"select","onUpdate:modelValue":t[8]||(t[8]=function(t){return e.estadoSelected=t}),name:"prueba"},[(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["v"])(e.estadoList,(function(e){return Object(n["p"])(),Object(n["d"])("option",{key:e.estadosEvaluacionId,value:e.estadosEvaluacionId},Object(n["z"])(e.nombre),9,["value"])})),128))],512),[[n["D"],e.estadoSelected]])])),re,se])):Object(n["e"])("",!0),"visualizar"==e.action?(Object(n["p"])(),Object(n["d"])("div",le,[ue,de,Object(n["g"])("span",null,Object(n["z"])(e.evaluacion.estado),1),be,fe])):Object(n["e"])("",!0),Object(n["g"])("div",null,["visualizar"!=e.action&&e.isAnalista?(Object(n["p"])(),Object(n["d"])("div",pe,[ge,Object(n["g"])("button",{class:"link",onClick:t[9]||(t[9]=function(t){return e.startQuiz()}),disabled:(!e.selectedObra.obraId||!e.selectedListaVerificacion.listaVerificacionId)&&!e.$route.params.id||e.blockRealizarPrueba}," Realizar prueba ",8,["disabled"]),e.pruebas.listaRecords.length>0&&e.isAnalista?(Object(n["p"])(),Object(n["d"])("button",{key:0,class:"action-button massive evaluacion",onClick:t[10]||(t[10]=function(t){return e.deleteMassive()})}," Eliminación masiva ")):Object(n["e"])("",!0)])):Object(n["e"])("",!0),Object(n["g"])(p,{dataSource:e.pruebas,columns:e.columns,config:e.config,actions:e.actions,rows:e.rows,rowHeaderStyle:"thin",rowBodyStyle:"thin",onMovePage:t[11]||(t[11]=function(){}),onSelectedList:e.selectedList},null,8,["dataSource","columns","config","actions","rows","onSelectedList"])]),"registrar"==e.action||e.esAltaGerencia||e.isJefeRiesgos?Object(n["e"])("",!0):(Object(n["p"])(),Object(n["d"])("div",Oe,[Object(n["g"])("div",he,[je,ve,"editar"==e.action&&e.isEspecialista?(Object(n["p"])(),Object(n["d"])("div",me,[ye,Object(n["g"])("div",ke,[Object(n["H"])(Object(n["g"])("input",{class:"comentario-box",type:"text","onUpdate:modelValue":t[12]||(t[12]=function(t){return e.comentarioInput=t}),placeholder:"Escribe tu comentario"},null,512),[[n["E"],e.comentarioInput]]),Object(n["g"])("button",{class:"action-button blocked comentario-button",onClick:t[13]||(t[13]=function(){return e.sendMessage&&e.sendMessage.apply(e,arguments)})}," Enviar ")]),we])):Object(n["e"])("",!0),0!=e.observaciones.length?(Object(n["p"])(),Object(n["d"])("div",Ie,[(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["v"])(e.observaciones,(function(e,t){return Object(n["p"])(),Object(n["d"])("div",{class:"comentario-lista",key:e.descripcion},[Object(n["g"])("div",Ee,[Object(n["g"])("img",{src:a("3dbb"),alt:"userImage",class:"userImage"},null,8,["src"]),Object(n["g"])("div",null,[Object(n["g"])("h4",null,Object(n["z"])(e.nombreUsuario)+" "+Object(n["z"])("("+e.usuarioRol+")"),1),Object(n["g"])("p",null,Object(n["z"])(e.descripcion),1)]),Object(n["g"])("p",null,Object(n["z"])(e.fechaCreacion),1),0==t?(Object(n["p"])(),Object(n["d"])("p",xe,"Último mensaje")):Object(n["e"])("",!0)])])})),128))])):(Object(n["p"])(),Object(n["d"])("div",Ce,[Re]))])]))]),Se])])],64)})),Ve=a("5530"),ze=a("1da1"),Ae=(a("96cf"),a("d3b7"),a("99af"),a("3ca3"),a("ddb0"),a("2b3d"),a("d81d"),a("7db0"),a("a9e3"),a("4de4"),a("159b"),a("f464")),Te=a("b7ff"),Me=a("9fbc"),De=a("d43e"),Ne=a("5c40"),Be=a("c1df"),Pe=a.n(Be),$e=a("2fc2"),Je=a("3e2f"),He=a("705f"),qe=a("f50d"),Ue=a("b74e"),Fe=Object(Ne["l"])({components:{NavBar:Ae["a"],Grid:Me["a"],ConfirmationModal:Te["a"],Modal:He["a"]},computed:{verifyPruebaCompleta:function(){return this.pruebas.listaRecords.some((function(e){return e.estado="Completa"}))},selectedListaVerificacion:function(){return this.$store.getters["listaVerificacionModule/selectedListaVerificacion"]},selectedObra:function(){return this.$store.getters["obraModule/selectedObra"]},evaluacion:function(){return this.$store.getters["evaluacionModule/obtenerEvaluacion"]},displayButtonAction:function(){switch(this.action){case"visualizar":return"Editar";case"registrar":return"Guardar";case"editar":return"Guardar";default:return"Editar"}}},data:function(){return{estadoList:[],observaciones:[],estadoSelected:"",comentarioInput:"",userInfoJson:Object(De["h"])(),action:"visualizar",pruebas:Je["d"],columns:$e["h"],esAltaGerencia:!1,isAnalista:!1,isJefeRiesgos:!1,isEspecialista:!1,config:{deleteEntity:"",entity:$e["m"].PRUEBA},actions:[{icon:"fas fa-trash-alt",type:$e["e"].DELETE,method:this.delete},{icon:"fas fa-eye",type:$e["e"].EDIT,method:this.edit}],rows:1,codigoListaVerificacion:"",codigoObra:"",obras:[],listasVerificacion:[],timeout:void 0,id:"",modalTitle:"",showModalConfirmation:!1,entityList:[],massiveDelete:!1,message:null,loading:!1,error:!1,blockRealizarPrueba:!1}},methods:{downloadPDF:function(){var e=this;return Object(ze["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:try{fetch("".concat($e["c"],"evaluacion/informe/").concat(e.evaluacion.codigo),{method:"GET",headers:new Headers({"Content-Type":"arraybuffer",Authorization:"Bearer "+localStorage.getItem("token")})}).then((function(e){return e.blob()})).then((function(e){var t=new Blob([e],{type:"application/pdf"}),a=URL.createObjectURL(t);window.open(a)}))}catch(a){console.log(a)}case 1:case"end":return t.stop()}}),t)})))()},sendMessage:function(){var e=this;return Object(ze["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={Descripcion:e.comentarioInput,UsuarioId:e.userInfoJson.id,EvaluacionId:e.evaluacion.evaluacionId},t.prev=1,t.next=4,fetch("".concat($e["c"],"observaciones"),{method:"POST",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}),body:JSON.stringify(a)});case 4:return n=t.sent,t.next=7,Object(Ue["a"])(n);case 7:e.observaciones.unshift({nombreUsuario:e.userInfoJson.nombres+" "+e.userInfoJson.apellidos,fechaCreacion:new Date,descripcion:e.comentarioInput,usuarioRol:e.userInfoJson.rol}),e.comentarioInput="",t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})))()},calculateTimeFromNow:function(e){return Pe.a.tz.setDefault("America/Lima"),Pe()(e).locale("es").fromNow()},delete:function(e){this.id=e,this.modalTitle="Está seguro que desea eliminar la prueba "+e+"?",this.showModalConfirmation=!0},confirmMassiveDelete:function(){var e=this;return Object(ze["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.entityList.map(function(){var t=Object(ze["a"])(regeneratorRuntime.mark((function t(a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.pruebas.listaRecords.find((function(e){return e.id==+a})),!n){t.next=11;break}return t.prev=2,t.next=5,fetch("".concat($e["c"],"prueba/").concat(n.pruebaId),{method:"DELETE",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 5:t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](2),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}()));case 2:e.massiveDelete=!1,e.showModalConfirmation=!1,e.modalTitle="",e.message="Los pruebas fueron eliminadas",setTimeout(Object(ze["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchEvaluacion();case 2:e.message=null;case 3:case"end":return t.stop()}}),t)}))),2e3);case 7:case"end":return t.stop()}}),t)})))()},edit:function(e){var t=this.pruebas.listaRecords.find((function(t){return t.id==Number(e)}));"Pendiente"==(null===t||void 0===t?void 0:t.estado)?this.$router.push("/evaluacion/".concat(this.evaluacion.codigo,"/prueba/").concat(t.codigo)):this.$router.push("/lista-verificacion/".concat(this.selectedListaVerificacion.codigo,"/prueba/").concat(null===t||void 0===t?void 0:t.codigo,"/resumen"))},selectedList:function(e){this.entityList=e},handleError:function(){this.message=null},closeModal:function(){this.showModalConfirmation=!1},deleteMassive:function(){this.entityList.length>0?(this.massiveDelete=!0,this.showModalConfirmation=!0,this.modalTitle="Está seguro que desea eliminar las pruebass seleccionadas ?"):(this.message="Debe seleccionar al menos una prueba",this.error=!0)},confirmDelete:function(){var e=this;return Object(ze["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.closeModal(),a=e.pruebas.listaRecords.find((function(t){return t.id==Number(e.id)})),t.prev=2,t.next=5,fetch("".concat($e["c"],"prueba/").concat(null===a||void 0===a?void 0:a.pruebaId),{method:"DELETE",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 5:t.sent,e.message="La prueba fue eliminada",e.id="",setTimeout(Object(ze["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchEvaluacion();case 2:e.message=null;case 3:case"end":return t.stop()}}),t)}))),2e3),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](2),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[2,11]])})))()},searchObra:function(){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout(Object(ze["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat($e["c"],"obras/lista?filter=").concat(e.codigoObra),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return a=t.sent,t.next=6,a.json();case 6:e.obras=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])}))),1e3)},fetchListListaVerificacion:function(){var e=this;return Object(ze["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat($e["c"],"listaverificaciones/lista?filter=").concat(e.codigoListaVerificacion),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return a=t.sent,t.next=6,a.json();case 6:e.listasVerificacion=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},searchListaVerificacion:function(){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout(Object(ze["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchListListaVerificacion();case 2:case"end":return t.stop()}}),t)}))),1e3)},SelectObra:function(e){this.$store.dispatch("obraModule/guardarObra",Object(Ve["a"])({},e)),this.obras=[],this.codigoObra=e.codigo+"-"+e.nombre},selectListaVerificacion:function(e){this.$store.dispatch("listaVerificacionModule/guardarListaVerificacion",Object(Ve["a"])({},e)),this.listasVerificacion=[],this.codigoListaVerificacion=e.codigo+"-"+e.nombre},startQuiz:function(){var e=this;return Object(ze["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={EvaluacionCodigo:e.evaluacion.codigo,EstadoEvaluacion:e.evaluacion.estado,EvaluacionNombre:e.evaluacion.nombre,ObraId:e.selectedObra.obraId,ListaVerificacionId:e.selectedListaVerificacion.listaVerificacionId,UsuarioId:e.userInfoJson.id},console.log(a),t.prev=2,t.next=5,fetch("".concat($e["c"],"evaluacion"),{method:"POST",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}),body:JSON.stringify(a)});case 5:t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](2),console.log(t.t0);case 10:e.$router.push("/evaluacion/".concat(e.evaluacion.codigo,"/prueba/nuevo"));case 11:case"end":return t.stop()}}),t,null,[[2,7]])})))()},preloadFormValues:function(){this.selectedListaVerificacion.fechaCreacion&&(this.codigoListaVerificacion=this.selectedListaVerificacion.codigo+"-"+this.selectedListaVerificacion.nombre),this.selectedObra.codigo&&(this.codigoObra=this.selectedObra.codigo+"-"+this.selectedObra.nombre)},submit:function(){var e=this;"registrar"===this.action?Object(ze["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat($e["c"],"evaluacion/activar/").concat(e.evaluacion.evaluacionId),{method:"PUT",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),console.log(t.t0);case 8:e.$router.push("/dashboard");case 9:case"end":return t.stop()}}),t,null,[[0,5]])})))():"visualizar"===this.action?this.action="editar":Object(ze["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={nombre:e.evaluacion.nombre,estado:e.estadoSelected,codigoEspecialista:e.isEspecialista?e.userInfoJson.codigo:null},t.prev=1,t.next=4,fetch("".concat($e["c"],"evaluacion/").concat(e.evaluacion.evaluacionId),{method:"PUT",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}),body:JSON.stringify(a)});case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](1),console.log(t.t0);case 9:e.$router.push("/dashboard");case 10:case"end":return t.stop()}}),t,null,[[1,6]])})))()},fetchEvaluacion:function(){var e=this;return Object(ze["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat($e["c"],"evaluacion/").concat(e.$route.params.id),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return a=t.sent,t.next=6,a.json();case 6:n=t.sent,e.estadoSelected=n.estadoEvaluacionId,n.observacionLista?e.observaciones=n.observacionLista.filter((function(e){return null!=e.nombreUsuario})):e.observaciones=[],e.codigoListaVerificacion=n.codigoConcatenadoListaVerificacion,e.codigoObra=n.codigoConcatenadoObra,e.pruebas.numeroPaginas=1,e.pruebas.totalRecords=1,e.selectedListaVerificacion.fechaCreacion=n.listaVerificacionFechaCreacion,e.selectedListaVerificacion.requerimientosCount=n.requerimientosCount,e.selectedListaVerificacion.codigo=n.codigoListaVerificacion,e.selectedListaVerificacion.listaVerificacionId=n.listaVerificacionId,e.selectedObra.obraId=n.obraId,e.pruebas.listaRecords=[],n.pruebaList.forEach((function(t,a){e.pruebas.listaRecords.push({id:a+1,fechaCreacion:new Date(t.fechaCreacion).toLocaleDateString(),estado:t.visibilidad?"Completa":"Pendiente",pruebaId:t.pruebaId,codigo:t.codigo})})),e.blockRealizarPrueba=e.pruebas.listaRecords.some((function(e){return"Pendiente"==e.estado})),e.rows=e.pruebas.listaRecords.length,e.$store.dispatch("evaluacionModule/guardarEvaluacion",Object(Ve["a"])(Object(Ve["a"])({},e.evaluacion),{},{evaluacionId:n.evaluacionId,codigo:n.codigo,nombre:n.nombre,estado:n.estado,visibilidad:n.visibilidad,fechaCreacion:new Date(n.fechaCreacion).toLocaleDateString()})),t.next=28;break;case 25:t.prev=25,t.t0=t["catch"](0),console.log(t.t0);case 28:case"end":return t.stop()}}),t,null,[[0,25]])})))()},fetchEvaluacionEstados:function(){var e=this;return Object(ze["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat($e["c"],"estadoevaluacion/lista"),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return a=t.sent,t.next=6,a.json();case 6:e.estadoList=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()}},unmounted:function(){this.$store.dispatch("obraModule/guardarObra",Object(De["e"])()),this.$store.dispatch("listaVerificacionModule/guardarListaVerificacion",Object(De["i"])()),this.$store.dispatch("evaluacionModule/guardarEvaluacion",Object(De["b"])()),this.$store.dispatch("pruebaModule/guardarPrueba",Object(De["f"])())},mounted:function(){var e=this;Object(ze["a"])(regeneratorRuntime.mark((function t(){var a,n,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(qe["a"])();case 2:if(e.userInfoJson=t.sent,e.evaluacion.action&&(e.action=e.evaluacion.action),e.userInfoJson.rol==$e["o"].ALTA_GERENCIA&&(e.esAltaGerencia=!0),e.userInfoJson.rol==$e["o"].ANALISTA&&(e.isAnalista=!0),e.userInfoJson.rol==$e["o"].JEFE_DE_RIESGOS&&(e.isJefeRiesgos=!0),e.userInfoJson.rol==$e["o"].ESPECIALISTA&&(e.isEspecialista=!0),e.userInfoJson.rol!==$e["o"].ANALISTA&&(e.actions=[{icon:"fas fa-eye",type:$e["e"].EDIT,method:e.edit}]),e.$route.params.id){t.next=27;break}return e.pruebas={listaRecords:[],numeroPaginas:1,totalRecords:0},t.prev=11,t.next=14,fetch("".concat($e["c"],"evaluacion/ultimoCodigo"),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 14:return a=t.sent,t.next=17,a.json();case 17:n=t.sent,c=n.codigo,e.$store.dispatch("evaluacionModule/guardarEvaluacion",Object(Ve["a"])(Object(Ve["a"])({},e.evaluacion),{},{codigo:c,fechaCreacion:(new Date).toLocaleDateString()})),t.next=25;break;case 22:t.prev=22,t.t0=t["catch"](11),console.log(t.t0);case 25:t.next=31;break;case 27:return t.next=29,e.fetchEvaluacionEstados();case 29:return t.next=31,e.fetchEvaluacion();case 31:case"end":return t.stop()}}),t,null,[[11,22]])})))()}});a("a121");Fe.render=Le,Fe.__scopeId="data-v-7974a40d";t["default"]=Fe},"3e2f":function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"f",(function(){return c})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}));var n=[{name:"High - 2013",data:[12,29,33,36,32,32,33]},{name:"Low - 2013",data:[28,11,14,18,17,13,13]}],c=[{data:[{x:"New Delhi",y:218},{x:"Kolkata",y:149},{x:"Mumbai",y:184},{x:"Ahmedabad",y:55},{x:"Bangaluru",y:84},{x:"Pune",y:31},{x:"Chennai",y:70},{x:"Jaipur",y:30},{x:"Surat",y:44},{x:"Hyderabad",y:68},{x:"Lucknow",y:28},{x:"Indore",y:19},{x:"Kanpur",y:29}]}],o={listaRecords:[],numeroPaginas:1,totalRecords:0},i=[{codigo:"TR001",fechaInicio:"05/06/2021",fechaFin:"11/06/2021",estado:"Solucionado",evaluacion:"EV001-Departamento Bohem",responsable:"Luis Quispe"},{codigo:"TR002",fechaInicio:"01/01/2021",fechaFin:"07/01/2021",estado:"Asignado",evaluacion:"EV002-Departamento Plaza 27",responsable:"Marcelo Lopez"}],r=[{codigo:"EV001",obra:"OB001-Departamento Bohem",nivelRiesgo:"Bajo",porcentajeCumplimiento:"30%",duracion:"12"},{codigo:"EV002",obra:"OB002-Departamento Plaza 27",nivelRiesgo:"Medio",porcentajeCumplimiento:"60%",duracion:"24"}],s=[{normativa:"29783",codigoEvaluacion:"EV001",evaluacion:"Evaluacion de elementos de seguridad",nivelRiesgo:"Medio",fechaCreacion:"15/05/2021"},{normativa:"ISO 45001",codigoEvaluacion:"EV002",evaluacion:"Evaluacion de elementos peligrosos",nivelRiesgo:"Bajo",fechaCreacion:"25/05/2021"}]},"571a":function(e,t,a){"use strict";a("917c")},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var n=a("1d80"),c=a("5899"),o="["+c+"]",i=RegExp("^"+o+o+"*"),r=RegExp(o+o+"*$"),s=function(e){return function(t){var a=String(n(t));return 1&e&&(a=a.replace(i,"")),2&e&&(a=a.replace(r,"")),a}};e.exports={start:s(1),end:s(2),trim:s(3)}},"5ef3":function(e,t,a){},"66b9":function(e,t,a){},"682b":function(e,t,a){"use strict";function n(e){var t=new Date(e),a=Date.now()-t.getTime(),n=new Date(a);return Math.abs(n.getUTCFullYear()-1970)}a.d(t,"a",(function(){return n}))},7156:function(e,t,a){var n=a("861d"),c=a("d2bb");e.exports=function(e,t,a){var o,i;return c&&"function"==typeof(o=t.constructor)&&o!==a&&n(i=o.prototype)&&i!==a.prototype&&c(e,i),e}},"7db0":function(e,t,a){"use strict";var n=a("23e7"),c=a("b727").find,o=a("44d2"),i="find",r=!0;i in[]&&Array(1)[i]((function(){r=!1})),n({target:"Array",proto:!0,forced:r},{find:function(e){return c(this,e,arguments.length>1?arguments[1]:void 0)}}),o(i)},"917c":function(e,t,a){},"9fbc":function(e,t,a){"use strict";var n=a("7a23"),c=Object(n["J"])("data-v-ac324ebe");Object(n["s"])("data-v-ac324ebe");var o={class:"grid"},i={key:0},r={key:1},s={key:0},l=Object(n["g"])("br",null,null,-1),u={key:0},d={key:1,class:"no-data"},b={key:0},f={key:1},p={key:0};Object(n["q"])();var g=c((function(e,t,a,c,g,O){var h,j,v;return Object(n["p"])(),Object(n["d"])(n["a"],null,[Object(n["g"])("table",o,[Object(n["g"])("thead",{class:e.rowHeaderStyle?"".concat(e.rowHeaderStyle," header-grid"):"header-grid"},[Object(n["g"])("tr",null,[(null===(h=e.actions)||void 0===h?void 0:h.length)>0&&"delete"==e.actions[0].type&&e.dataSource.listaRecords.length>0?(Object(n["p"])(),Object(n["d"])("th",i,[Object(n["H"])(Object(n["g"])("input",{type:"checkbox",id:"checkbox","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.massiveCheck=t})},null,512),[[n["B"],e.massiveCheck]])])):Object(n["e"])("",!0),(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["v"])(e.columns,(function(e){return Object(n["p"])(),Object(n["d"])("th",{key:e.field,style:{textAlign:e.align?e.align:"left"}},Object(n["z"])(e.title),5)})),128)),(null===(j=e.actions)||void 0===j?void 0:j.length)>0?(Object(n["p"])(),Object(n["d"])("th",r,"Acciones")):Object(n["e"])("",!0)])],2),e.dataSource.listaRecords&&0===(null===(v=e.dataSource.listaRecords)||void 0===v?void 0:v.length)?(Object(n["p"])(),Object(n["d"])("div",s,[l,e.rowBodyStyle?(Object(n["p"])(),Object(n["d"])("p",d,"Sin registros")):(Object(n["p"])(),Object(n["d"])("h3",u,"No hay datos registrados"))])):Object(n["e"])("",!0),Object(n["g"])("tbody",{class:e.rowBodyStyle?e.rowBodyStyle:""},[(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["v"])(e.rows,(function(a,c){var o,i;return Object(n["p"])(),Object(n["d"])("tr",{key:a},[(null===(o=e.actions)||void 0===o?void 0:o.length)>0&&"delete"==e.actions[0].type&&e.dataSource.listaRecords.length>0?(Object(n["p"])(),Object(n["d"])("td",b,[e.dataSource.listaRecords&&e.dataSource.listaRecords[c]?Object(n["H"])((Object(n["p"])(),Object(n["d"])("input",{key:0,type:"checkbox",id:e.dataSource.listaRecords[c].id,value:e.dataSource.listaRecords[c].id,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.checkedEntities=t})},null,8,["id","value"])),[[n["B"],e.checkedEntities]]):Object(n["e"])("",!0)])):Object(n["e"])("",!0),(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["v"])(e.columns,(function(t){return Object(n["p"])(),Object(n["d"])("td",{key:t.field},[Object(n["g"])("p",{style:{textAlign:t.align?t.align:"left"}},Object(n["z"])(e.getValue(t.field,e.dataSource.listaRecords,a-1)),5)])})),128)),(null===(i=e.actions)||void 0===i?void 0:i.length)>0?(Object(n["p"])(),Object(n["d"])("td",f,[(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["v"])(e.actions,(function(t){return Object(n["p"])(),Object(n["d"])("span",{key:t.type},[e.dataSource.listaRecords[c]?(Object(n["p"])(),Object(n["d"])("i",{key:0,class:t.icon,style:{"margin-left":"18px"},onClick:function(a){return t.method(e.dataSource.listaRecords[c].id,e.dataSource.listaRecords[c].codigo,e.dataSource.listaRecords[c].entity)}},null,10,["onClick"])):Object(n["e"])("",!0)])})),128))])):Object(n["e"])("",!0)])})),128))],2)]),e.dataSource.numeroPaginas>1?(Object(n["p"])(),Object(n["d"])("div",p,[(Object(n["p"])(!0),Object(n["d"])(n["a"],null,Object(n["v"])(e.dataSource.numeroPaginas,(function(t){return Object(n["p"])(),Object(n["d"])("div",{key:t,class:"pageButton",onClick:function(a){return e.goPage(t)}},Object(n["z"])(t),9,["onClick"])})),128))])):Object(n["e"])("",!0)],64)})),O=(a("a9e3"),a("d81d"),a("682b")),h=a("5c40");function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var v=function e(t,a,n){j(this,e),this.listaRecords=t,this.numeroPaginas=a,this.totalRecords=n},m=Object(h["l"])({props:{columns:{type:Array,required:!0},dataSource:{type:v,required:!0},config:{type:null,required:!1},actions:{type:null,required:!1,default:[]},method:{type:Function,required:!1},rows:{type:Number,required:!1,default:5},pages:{type:Number,required:!0},rowHeaderStyle:{type:String,required:!1},rowBodyStyle:{type:String,required:!1}},emits:["selectedList","movePage"],data:function(){return{massiveCheck:!1,checkedEntities:[]}},watch:{massiveCheck:function(){this.massiveCheck?this.checkedEntities=this.dataSource.listaRecords.map((function(e){return e.id})):this.checkedEntities=[]},checkedEntities:function(){this.$emit("selectedList",this.checkedEntities)}},methods:{goPage:function(e){this.$emit("movePage",e)},getValue:function(e,t,a){if(t)return t[a]?"fechaNacimiento"===e?Object(O["a"])(t[a][e]):t[a][e]:""}}});a("571a");m.render=g,m.__scopeId="data-v-ac324ebe";t["a"]=m},a121:function(e,t,a){"use strict";a("66b9")},a9e3:function(e,t,a){"use strict";var n=a("83ab"),c=a("da84"),o=a("94ca"),i=a("6eeb"),r=a("5135"),s=a("c6b6"),l=a("7156"),u=a("c04e"),d=a("d039"),b=a("7c73"),f=a("241c").f,p=a("06cf").f,g=a("9bf2").f,O=a("58a8").trim,h="Number",j=c[h],v=j.prototype,m=s(b(v))==h,y=function(e){var t,a,n,c,o,i,r,s,l=u(e,!1);if("string"==typeof l&&l.length>2)if(l=O(l),t=l.charCodeAt(0),43===t||45===t){if(a=l.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(l.charCodeAt(1)){case 66:case 98:n=2,c=49;break;case 79:case 111:n=8,c=55;break;default:return+l}for(o=l.slice(2),i=o.length,r=0;r<i;r++)if(s=o.charCodeAt(r),s<48||s>c)return NaN;return parseInt(o,n)}return+l};if(o(h,!j(" 0o1")||!j("0b1")||j("+0x1"))){for(var k,w=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof w&&(m?d((function(){v.valueOf.call(a)})):s(a)!=h)?l(new j(y(t)),a,w):y(t)},I=n?f(j):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),E=0;I.length>E;E++)r(j,k=I[E])&&!r(w,k)&&g(w,k,p(j,k));w.prototype=v,v.constructor=w,i(c,h,w)}},aa14:function(e,t,a){"use strict";a("5ef3")},b7ff:function(e,t,a){"use strict";var n=a("7a23"),c=Object(n["J"])("data-v-ea440b04");Object(n["s"])("data-v-ea440b04");var o={key:0,class:"modal"},i=Object(n["g"])("i",{class:"far fa-times-circle fa-2x"},null,-1),r={class:"flex-button"};Object(n["q"])();var s=c((function(e,t,a,c,s,l){var u=Object(n["x"])("backdrop");return Object(n["p"])(),Object(n["d"])(n["a"],null,[Object(n["g"])(u,{show:e.show,onClose:e.tryClose,closable:!1},null,8,["show","onClose"]),e.show?(Object(n["p"])(),Object(n["d"])("div",o,[i,Object(n["g"])("p",null,Object(n["z"])(e.title),1),Object(n["g"])("div",r,[Object(n["g"])("button",{onClick:t[1]||(t[1]=function(t){return e.confirm()}),class:"action-button"},"Aceptar"),Object(n["g"])("button",{style:{background:"var(--danger)"},onClick:t[2]||(t[2]=function(t){return e.cancel()}),class:"action-button"}," Cancelar ")])])):Object(n["e"])("",!0)],64)})),l=a("5c40"),u=a("c2de"),d=Object(l["l"])({components:{Backdrop:u["a"]},props:{show:{type:Boolean,required:!0},title:{type:String,required:!1},fixed:{type:Boolean,required:!1,default:!1},error:{type:Boolean,required:!0},loading:{type:Boolean,required:!0},massiveDelete:{type:Boolean,required:!1}},emits:["confirmMassive","close","confirm","cancel"],methods:{tryClose:function(){this.$emit("close")},confirm:function(){this.massiveDelete?this.$emit("confirmMassive"):this.$emit("confirm")},cancel:function(){this.$emit("cancel")}}});a("aa14");d.render=s,d.__scopeId="data-v-ea440b04";t["a"]=d},d81d:function(e,t,a){"use strict";var n=a("23e7"),c=a("b727").map,o=a("1dde"),i=o("map");n({target:"Array",proto:!0,forced:!i},{map:function(e){return c(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-4df60e2a.05973566.js.map